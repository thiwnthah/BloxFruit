loadstring(game:HttpGet("bG9jYWwgQ29uZmlnc19IVUIgPSB7CiAgQ29yX0h1YiA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMCwgMCksCiAgQ29yX09wdGlvbnMgPSBDb2xvcjMuZnJvbVJHQigwLCAyNTUsIDApLAogIENvcl9TdHJva2UgPSBDb2xvcjMuZnJvbVJHQigwLCAwLCAyNTUpLAogIENvcl9UZXh0ID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSksCiAgQ29yX0RhcmtUZXh0ID0gQ29sb3IzLmZyb21SR0IoNTAsIDUwLCA1MCksCiAgQ29ybmVyX1JhZGl1cyA9IFVEaW0ubmV3KDAsIDQpLAogIFRleHRfRm9udCA9IEVudW0uRm9udC5Hb3RoYW1Cb2xkCn0KCmxvY2FsIENvcmVHdWkgPSBnYW1lOkdldFNlcnZpY2UoIkNvcmVHdWkiKQpsb2NhbCBUd2VlblNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlR3ZWVuU2VydmljZSIpCmxvY2FsIFVzZXJJbnB1dFNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlVzZXJJbnB1dFNlcnZpY2UiKQoKbG9jYWwgZnVuY3Rpb24gQ3JlYXRlKGluc3RhbmNlLCBwYXJlbnQsIHByb3BzKQogIGxvY2FsIG5ldyA9IEluc3RhbmNlLm5ldyhpbnN0YW5jZSwgcGFyZW50KQogIGlmIHByb3BzIHRoZW4KICAgIHRhYmxlLmZvcmVhY2gocHJvcHMsIGZ1bmN0aW9uKHByb3AsIHZhbHVlKQogICAgICBuZXdbcHJvcF0gPSB2YWx1ZQogICAgZW5kKQogIGVuZAogIHJldHVybiBuZXcKZW5kCgpsb2NhbCBmdW5jdGlvbiBTZXRQcm9wcyhpbnN0YW5jZSwgcHJvcHMpCiAgaWYgaW5zdGFuY2UgYW5kIHByb3BzIHRoZW4KICAgIHRhYmxlLmZvcmVhY2gocHJvcHMsIGZ1bmN0aW9uKHByb3AsIHZhbHVlKQogICAgICBpbnN0YW5jZVtwcm9wXSA9IHZhbHVlCiAgICBlbmQpCiAgZW5kCiAgcmV0dXJuIGluc3RhbmNlCmVuZAoKbG9jYWwgZnVuY3Rpb24gQ29ybmVyKHBhcmVudCwgcHJvcHMpCiAgbG9jYWwgbmV3ID0gQ3JlYXRlKCJVSUNvcm5lciIsIHBhcmVudCkKICBuZXcuQ29ybmVyUmFkaXVzID0gQ29uZmlnc19IVUIuQ29ybmVyX1JhZGl1cwogIGlmIHByb3BzIHRoZW4KICAgIFNldFByb3BzKG5ldywgcHJvcHMpCiAgZW5kCiAgcmV0dXJuIG5ldwplbmQKCmxvY2FsIGZ1bmN0aW9uIFN0cm9rZShwYXJlbnQsIHByb3BzKQogIGxvY2FsIG5ldyA9IENyZWF0ZSgiVUlTdHJva2UiLCBwYXJlbnQpCiAgbmV3LkNvbG9yID0gQ29uZmlnc19IVUIuQ29yX1N0cm9rZQogIG5ldy5BcHBseVN0cm9rZU1vZGUgPSAiQm9yZGVyIgogIGlmIHByb3BzIHRoZW4KICAgIFNldFByb3BzKG5ldywgcHJvcHMpCiAgZW5kCiAgcmV0dXJuIG5ldwplbmQKCmxvY2FsIGZ1bmN0aW9uIENyZWF0ZVR3ZWVuKGluc3RhbmNlLCBwcm9wLCB2YWx1ZSwgdGltZSwgdHdlZW5XYWl0KQogIGxvY2FsIHR3ZWVuID0gVHdlZW5TZXJ2aWNlOkNyZWF0ZShpbnN0YW5jZSwKICBUd2VlbkluZm8ubmV3KHRpbWUsIEVudW0uRWFzaW5nU3R5bGUuTGluZWFyKSwKICB7W3Byb3BdID0gdmFsdWV9KQogIHR3ZWVuOlBsYXkoKQogIGlmIHR3ZWVuV2FpdCB0aGVuCiAgICB0d2Vlbi5Db21wbGV0ZWQ6V2FpdCgpCiAgZW5kCmVuZAoKbG9jYWwgZnVuY3Rpb24gVGV4dFNldENvbG9yKGluc3RhbmNlKQogIGluc3RhbmNlLk1vdXNlRW50ZXI6Q29ubmVjdChmdW5jdGlvbigpCiAgICBDcmVhdGVUd2VlbihpbnN0YW5jZSwgIlRleHRDb2xvcjMiLCBDb2xvcjMuZnJvbVJHQigyOCwgMTIwLCAyMTIpLCAwLjQsIHRydWUpCiAgZW5kKQogIGluc3RhbmNlLk1vdXNlTGVhdmU6Q29ubmVjdChmdW5jdGlvbigpCiAgICBDcmVhdGVUd2VlbihpbnN0YW5jZSwgIlRleHRDb2xvcjMiLCBDb25maWdzX0hVQi5Db3JfVGV4dCwgMC40LCBmYWxzZSkKICBlbmQpCmVuZAoKbG9jYWwgU2NyZWVuR3VpID0gQ3JlYXRlKCJTY3JlZW5HdWkiLCBDb3JlR3VpLCB7CiAgTmFtZSA9ICJSRUR6IEhVQiBsaWJyYXJ5Igp9KQoKU2NyZWVuRmluZCA9IENvcmVHdWk6RmluZEZpcnN0Q2hpbGQoU2NyZWVuR3VpLk5hbWUpCmlmIFNjcmVlbkZpbmQgYW5kIFNjcmVlbkZpbmQgfj0gU2NyZWVuR3VpIHRoZW4KICBTY3JlZW5GaW5kOkRlc3Ryb3koKQplbmQKCmZ1bmN0aW9uIERlc3Ryb3lTY3JpcHQoKQogIFNjcmVlbkd1aTpEZXN0cm95KCkKZW5kCgpsb2NhbCBNZW51X05vdGlmaSA9IENyZWF0ZSgiRnJhbWUiLCBTY3JlZW5HdWksIHsKICBTaXplID0gVURpbTIubmV3KDAsIDMwMCwgMSwgMCksCiAgUG9zaXRpb24gPSBVRGltMi5uZXcoMSwgMCwgMCwgMCksCiAgQW5jaG9yUG9pbnQgPSBWZWN0b3IyLm5ldygxLCAwKSwKICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQp9KQoKbG9jYWwgUGFkZGluZyA9IENyZWF0ZSgiVUlQYWRkaW5nIiwgTWVudV9Ob3RpZmksIHsKICBQYWRkaW5nTGVmdCA9IFVEaW0ubmV3KDAsIDI1KSwKICBQYWRkaW5nVG9wID0gVURpbS5uZXcoMCwgMjUpLAogIFBhZGRpbmdCb3R0b20gPSBVRGltLm5ldygwLCA1MCkKfSkKCmxvY2FsIExpc3RMYXlvdXQgPSBDcmVhdGUoIlVJTGlzdExheW91dCIsIE1lbnVfTm90aWZpLCB7CiAgUGFkZGluZyA9IFVEaW0ubmV3KDAsIDE1KSwKICBWZXJ0aWNhbEFsaWdubWVudCA9ICJCb3R0b20iCn0pCgpmdW5jdGlvbiBNYWtlTm90aWZpKENvbmZpZ3MpCiAgbG9jYWwgVGl0bGUgPSBDb25maWdzLlRpdGxlIG9yICJSRUR6IEhVQiIKICBsb2NhbCB0ZXh0ID0gQ29uZmlncy5UZXh0IG9yICJOb3RpZmljYcOnw6NvIgogIGxvY2FsIHRpbWV3YWl0ID0gQ29uZmlncy5UaW1lIG9yIDUKICAKICBsb2NhbCBGcmFtZTEgPSBDcmVhdGUoIkZyYW1lIiwgTWVudV9Ob3RpZmksIHsKICAgIFNpemUgPSBVRGltMi5uZXcoMiwgMCwgMCwgMCksCiAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMSwKICAgIEF1dG9tYXRpY1NpemUgPSAiWSIsCiAgICBOYW1lID0gIlRpdGxlIgogIH0pCiAgCiAgbG9jYWwgRnJhbWUyID0gQ3JlYXRlKCJGcmFtZSIsIEZyYW1lMSwgewogICAgU2l6ZSA9IFVEaW0yLm5ldygwLCBNZW51X05vdGlmaS5TaXplLlguT2Zmc2V0IC0gNTAsIDAsIDApLAogICAgQmFja2dyb3VuZENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9IdWIsCiAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLCBNZW51X05vdGlmaS5TaXplLlguT2Zmc2V0LCAwLCAwKSwKICAgIEF1dG9tYXRpY1NpemUgPSAiWSIKICB9KUNvcm5lcihGcmFtZTIpCiAgCiAgbG9jYWwgVGV4dExhYmVsID0gQ3JlYXRlKCJUZXh0TGFiZWwiLCBGcmFtZTIsIHsKICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMjUpLAogICAgRm9udCA9IENvbmZpZ3NfSFVCLlRleHRfRm9udCwKICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxLAogICAgVGV4dCA9IFRpdGxlLAogICAgVGV4dFNpemUgPSAyMCwKICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDIwLCAwLCA1KSwKICAgIFRleHRYQWxpZ25tZW50ID0gIkxlZnQiLAogICAgVGV4dENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9UZXh0CiAgfSkKICAKICBsb2NhbCBUZXh0QnV0dG9uID0gQ3JlYXRlKCJUZXh0QnV0dG9uIiwgRnJhbWUyLCB7CiAgICBUZXh0ID0gIlgiLAogICAgRm9udCA9IENvbmZpZ3NfSFVCLlRleHRfRm9udCwKICAgIFRleHRTaXplID0gMjAsCiAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMSwKICAgIFRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyMDAsIDIwMCwgMjAwKSwKICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDEsIC01LCAwLCA1KSwKICAgIEFuY2hvclBvaW50ID0gVmVjdG9yMi5uZXcoMSwgMCksCiAgICBTaXplID0gVURpbTIubmV3KDAsIDI1LCAwLCAyNSkKICB9KQogIAogIGxvY2FsIFRleHRMYWJlbCA9IENyZWF0ZSgiVGV4dExhYmVsIiwgRnJhbWUyLCB7CiAgICBTaXplID0gVURpbTIubmV3KDEsIC0zMCwgMCwgMCksCiAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAyMCwgMCwgVGV4dEJ1dHRvbi5TaXplLlkuT2Zmc2V0ICsgMTApLAogICAgVGV4dFNpemUgPSAxNSwKICAgIFRleHRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfRGFya1RleHQsCiAgICBUZXh0WEFsaWdubWVudCA9ICJMZWZ0IiwKICAgIFRleHRZQWxpZ25tZW50ID0gIlRvcCIsCiAgICBBdXRvbWF0aWNTaXplID0gIlkiLAogICAgVGV4dCA9IHRleHQsCiAgICBGb250ID0gQ29uZmlnc19IVUIuVGV4dF9Gb250LAogICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEsCiAgICBBdXRvbWF0aWNTaXplID0gRW51bS5BdXRvbWF0aWNTaXplLlksCiAgICBUZXh0V3JhcHBlZCA9IHRydWUKICB9KQogIAogIGxvY2FsIEZyYW1lU2l6ZSA9IENyZWF0ZSgiRnJhbWUiLCBGcmFtZTIsIHsKICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMiksCiAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29uZmlnc19IVUIuQ29yX1N0cm9rZSwKICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDIsIDAsIDMwKSwKICAgIEJvcmRlclNpemVQaXhlbCA9IDAKICB9KUNvcm5lcihGcmFtZVNpemUpQ3JlYXRlKCJGcmFtZSIsIEZyYW1lMiwgewogICAgU2l6ZSA9IFVEaW0yLm5ldygwLCAwLCAwLCA1KSwKICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDAsIDEsIDUpLAogICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICB9KQogIAogIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgQ3JlYXRlVHdlZW4oRnJhbWVTaXplLCAiU2l6ZSIsIFVEaW0yLm5ldygwLCAwLCAwLCAyKSwgdGltZXdhaXQsIHRydWUpCiAgZW5kKQogIAogIFRleHRCdXR0b24uTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpCiAgICBDcmVhdGVUd2VlbihGcmFtZTIsICJQb3NpdGlvbiIsIFVEaW0yLm5ldygwLCAtMjAsIDAsIDApLCAwLjEsIHRydWUpCiAgICBDcmVhdGVUd2VlbihGcmFtZTIsICJQb3NpdGlvbiIsIFVEaW0yLm5ldygwLCBNZW51X05vdGlmaS5TaXplLlguT2Zmc2V0LCAwLCAwKSwgMC41LCB0cnVlKQogICAgRnJhbWUxOkRlc3Ryb3koKQogIGVuZCkKICAKICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgIENyZWF0ZVR3ZWVuKEZyYW1lMiwgIlBvc2l0aW9uIiwgVURpbTIubmV3KDAsIC0yMCwgMCwgMCksIDAuNSwgdHJ1ZSkKICAgIENyZWF0ZVR3ZWVuKEZyYW1lMiwgIlBvc2l0aW9uIiwgVURpbTIubmV3KCksIDAuMSwgdHJ1ZSl0YXNrLndhaXQodGltZXdhaXQpCiAgICBpZiBGcmFtZTIgdGhlbgogICAgICBDcmVhdGVUd2VlbihGcmFtZTIsICJQb3NpdGlvbiIsIFVEaW0yLm5ldygwLCAtMjAsIDAsIDApLCAwLjEsIHRydWUpCiAgICAgIENyZWF0ZVR3ZWVuKEZyYW1lMiwgIlBvc2l0aW9uIiwgVURpbTIubmV3KDAsIE1lbnVfTm90aWZpLlNpemUuWC5PZmZzZXQsIDAsIDApLCAwLjUsIHRydWUpCiAgICAgIEZyYW1lMTpEZXN0cm95KCkKICAgIGVuZAogIGVuZCkKZW5kCgpmdW5jdGlvbiBNYWtlV2luZG93KENvbmZpZ3MpCiAgbG9jYWwgdGl0bGUgPSBDb25maWdzLkh1Yi5UaXRsZSBvciAiUkVEeiBIVUIiCiAgbG9jYWwgQW5pbV9UaXRsZSA9IENvbmZpZ3MuSHViLkFuaW1hdGlvbiBvciAiYnkgOiByZWR6OTk5OSIKICAKICBsb2NhbCBLZXlTeXN0ZW0gPSBDb25maWdzLktleS5LZXlTeXN0ZW0gb3IgZmFsc2UKICBsb2NhbCBLZXlUaXRsZSA9IENvbmZpZ3MuS2V5LlRpdGxlIG9yICJLZXkgU3lzdGVtIgogIGxvY2FsIEtleURlc2NyaXB0aW9uID0gQ29uZmlncy5LZXkuRGVzY3JpcHRpb24gb3IgIi4tLiIKICBsb2NhbCBLZXlLZXkgPSBDb25maWdzLktleS5LZXlzIG9yIHsiMTIzIiwgIjMyMSJ9CiAgbG9jYWwgS2V5TGluayA9IENvbmZpZ3MuS2V5LktleUxpbmsgb3IgIiIKICBsb2NhbCBLZXlOb3RpZmljYXRpb25zID0gQ29uZmlncy5LZXkuTm90aWZpLk5vdGlmaWNhdGlvbnMgb3IgdHJ1ZQogIGxvY2FsIEtleU5vdFN1Y2Nlc3MgPSBDb25maWdzLktleS5Ob3RpZmkuSW5jb3JyZWN0a2V5IG9yICJUaGUga2V5IGlzIGluY29ycmVjdCIKICBsb2NhbCBLZXlTdWNjZXNzID0gQ29uZmlncy5LZXkuTm90aWZpLkNvcnJlY3RLZXkgb3IgIlJ1bm5pbmcgdGhlIFNjcmlwdC4uLiIKICBsb2NhbCBLZXlDb3B5S2V5TGluayA9IENvbmZpZ3MuS2V5Lk5vdGlmaS5Db3B5S2V5TGluayBvciAiQ29waWVkIHRvIENsaXBib2FyZCIKICAKICBpZiBLZXlTeXN0ZW0gdGhlbgogICAgbG9jYWwgS2V5TWVudSA9IENyZWF0ZSgiRnJhbWUiLCBTY3JlZW5HdWksIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCA0MDAsIDAsIDIyMCksCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAuNSwgMCwgMC41LCAwKSwKICAgICAgQmFja2dyb3VuZENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9IdWIsCiAgICAgIEFuY2hvclBvaW50ID0gVmVjdG9yMi5uZXcoMC41LCAwLjUpLAogICAgICBBY3RpdmUgPSB0cnVlLAogICAgICBEcmFnZ2FibGUgPSB0cnVlCiAgICB9KUNvcm5lcihLZXlNZW51KQogICAgCiAgICBsb2NhbCBDbG9zZUJ1dHRvbiA9IENyZWF0ZSgiVGV4dEJ1dHRvbiIsIEtleU1lbnUsIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCAzMCwgMCwgMzApLAogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygxLCAtMTAsIDAsIDUpLAogICAgICBBbmNob3JQb2ludCA9IFZlY3RvcjIubmV3KDEsIDApLAogICAgICBUZXh0ID0gIlgiLAogICAgICBGb250ID0gRW51bS5Gb250LkZyZWRva2FPbmUsCiAgICAgIFRleHRTY2FsZWQgPSB0cnVlLAogICAgICBUZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjQwLCAwLCAwKSwKICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEsCiAgICB9KUNvcm5lcihDbG9zZUJ1dHRvbikKICAgIAogICAgbG9jYWwgVGl0bGUgPSBDcmVhdGUoIlRleHRMYWJlbCIsIEtleU1lbnUsIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAtODAsIDAsIDIwKSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMjAsIDAsIDUpLAogICAgICBUZXh0ID0gS2V5VGl0bGUsCiAgICAgIEZvbnQgPSBDb25maWdzX0hVQi5UZXh0X0ZvbnQsCiAgICAgIFRleHRTY2FsZWQgPSB0cnVlLAogICAgICBUZXh0Q29sb3IzID0gQ29uZmlnc19IVUIuQ29yX1RleHQsCiAgICAgIFRleHRYQWxpZ25tZW50ID0gIkxlZnQiLAogICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgfSkKICAgIAogICAgbG9jYWwgRGVzY3JpcHRpb24gPSBDcmVhdGUoIlRleHRMYWJlbCIsIEtleU1lbnUsIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAtODAsIDAsIDApLAogICAgICBUZXh0ID0gS2V5RGVzY3JpcHRpb24sCiAgICAgIFRleHRTaXplID0gMTcsCiAgICAgIFRleHRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfRGFya1RleHQsCiAgICAgIEZvbnQgPSBDb25maWdzX0hVQi5UZXh0X0ZvbnQsCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDIwLCAwLCAyNSksCiAgICAgIFRleHRYQWxpZ25tZW50ID0gIkxlZnQiLAogICAgICBBdXRvbWF0aWNTaXplID0gIlkiLAogICAgICBUZXh0WUFsaWdubWVudCA9ICJUb3AiLAogICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgfSkKICAgIAogICAgbG9jYWwgQ29uZmlybUJ1dHRvbiA9IENyZWF0ZSgiVGV4dEJ1dHRvbiIsIEtleU1lbnUsIHsKICAgICAgVGV4dCA9ICJYQUMgTkhBTiIsCiAgICAgIEZvbnQgPSBDb25maWdzX0hVQi5UZXh0X0ZvbnQsCiAgICAgIFRleHRTaXplID0gMjAsCiAgICAgIFRleHRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfVGV4dCwKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCAxNTAsIDAsIDQwKSwKICAgICAgQW5jaG9yUG9pbnQgPSBWZWN0b3IyLm5ldygxLCAwKSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMSwgLTM1LCAwLCAxNDApLAogICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29uZmlnc19IVUIuQ29yX09wdGlvbnMKICAgIH0pQ29ybmVyKENvbmZpcm1CdXR0b24pCiAgICAKICAgIGxvY2FsIEdldEtleUxpbmsgPSBDcmVhdGUoIlRleHRCdXR0b24iLCBLZXlNZW51LCB7CiAgICAgIFRleHQgPSAiR0VUIEtFWSBWMSIsCiAgICAgIEZvbnQgPSBDb25maWdzX0hVQi5UZXh0X0ZvbnQsCiAgICAgIFRleHRTaXplID0gMjAsCiAgICAgIFRleHRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfVGV4dCwKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCAxNTAsIDAsIDQwKSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMzUsIDAsIDE0MCksCiAgICAgIEJhY2tncm91bmRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfT3B0aW9ucwogICAgfSlDb3JuZXIoR2V0S2V5TGluaykKICAgIAogICAgbG9jYWwgVGV4dEJveCA9IENyZWF0ZSgiVGV4dEJveCIsIEtleU1lbnUsIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAtNzAsIDAsIDQwKSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMzUsIDAsIDkwKSwKICAgICAgQmFja2dyb3VuZENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9PcHRpb25zLAogICAgICBQbGFjZWhvbGRlclRleHQgPSAiWzxUSElXTiBUSEFIIEhVQj5dIiwKICAgICAgVGV4dCA9ICIiLAogICAgICBUZXh0Q29sb3IzID0gQ29uZmlnc19IVUIuQ29yX1RleHQsCiAgICAgIEZvbnQgPSBDb25maWdzX0hVQi5UZXh0X0ZvbnQsCiAgICAgIFRleHRTaXplID0gMjUKICAgIH0pQ29ybmVyKFRleHRCb3gpCiAgICAKICAgIGxvY2FsIEtleVZlcmlmeSA9IGZhbHNlCiAgICBDbG9zZUJ1dHRvbi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgbG9jYWwgVUlTY2FsZSA9IENyZWF0ZSgiVUlTY2FsZSIsIFNjcmVlbkd1aSkKICAgICAgQ3JlYXRlVHdlZW4oVUlTY2FsZSwgIlNjYWxlIiwgMCwgMC4yMCwgdHJ1ZSkKICAgICAgU2NyZWVuR3VpOkRlc3Ryb3koKQogICAgZW5kKQogICAgCiAgICBDb25maXJtQnV0dG9uLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICBmb3IgXyx2IGluIHBhaXJzKEtleUtleSkgZG8KICAgICAgICBpZiBUZXh0Qm94LlRleHQgPT0gdiB0aGVuCiAgICAgICAgICBLZXlWZXJpZnkgPSB0cnVlCiAgICAgICAgZW5kCiAgICAgIGVuZAogICAgICBpZiBLZXlOb3RpZmljYXRpb25zIGFuZCBub3QgS2V5VmVyaWZ5IHRoZW4KICAgICAgICBNYWtlTm90aWZpKHsKICAgICAgICAgIFRpdGxlID0gS2V5VGl0bGUsCiAgICAgICAgICBUZXh0ID0gS2V5Tm90U3VjY2VzcywKICAgICAgICAgIFRpbWUgPSA1CiAgICAgICAgfSkKICAgICAgZWxzZWlmIEtleU5vdGlmaWNhdGlvbnMgdGhlbgogICAgICAgIE1ha2VOb3RpZmkoewogICAgICAgICAgVGl0bGUgPSBLZXlUaXRsZSwKICAgICAgICAgIFRleHQgPSBLZXlTdWNjZXNzLAogICAgICAgICAgVGltZSA9IDUKICAgICAgICB9KQogICAgICBlbmQKICAgIGVuZCkKICAgIAogICAgR2V0S2V5TGluay5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgaWYgS2V5Tm90aWZpY2F0aW9ucyB0aGVuCiAgICAgICAgc2V0Y2xpcGJvYXJkKEtleUxpbmspCiAgICAgICAgTWFrZU5vdGlmaSh7CiAgICAgICAgICBUaXRsZSA9IEtleVRpdGxlLAogICAgICAgICAgVGV4dCA9IEtleUNvcHlLZXlMaW5rLAogICAgICAgICAgVGltZSA9IDUKICAgICAgICB9KQogICAgICBlbmQKICAgIGVuZCkKICAgIAogICAgcmVwZWF0IHRhc2sud2FpdCgpCiAgICB1bnRpbCBLZXlWZXJpZnkKICAgIGxvY2FsIFVJU2NhbGUgPSBDcmVhdGUoIlVJU2NhbGUiLCBLZXlNZW51KQogICAgQ3JlYXRlVHdlZW4oVUlTY2FsZSwgIlNjYWxlIiwgMCwgMC40MCwgdHJ1ZSkKICAgIEtleU1lbnU6RGVzdHJveSgpCiAgZW5kCiAgCiAgbG9jYWwgTWVudSA9IENyZWF0ZSgiRnJhbWUiLCBTY3JlZW5HdWksIHsKICAgIEJhY2tncm91bmRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfSHViLAogICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMC41LCAtNTAwLzIsIDAuNSwgLTI3MC8yKSwKICAgIEFjdGl2ZSA9IHRydWUsCiAgICBEcmFnZ2FibGUgPSB0cnVlCiAgfSlDb3JuZXIoTWVudSkKICAKICBsb2NhbCBUb3BCYXIgPSBDcmVhdGUoIkZyYW1lIiwgTWVudSwgewogICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEsCiAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDI1KSwKICAgIFZpc2libGUgPSBmYWxzZQogIH0pCiAgCiAgbG9jYWwgQnV0dG9uc0ZyYW1lID0gQ3JlYXRlKCJGcmFtZSIsIFRvcEJhciwgewogICAgU2l6ZSA9IFVEaW0yLm5ldygwLCA0MCwgMSwgLTUpLAogICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMSwgLTEwLCAwLCAyLjUpLAogICAgQW5jaG9yUG9pbnQgPSBWZWN0b3IyLm5ldygxLCAwKSwKICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgfSkKICAKICBsb2NhbCBUaXRsZSA9IENyZWF0ZSgiVGV4dExhYmVsIiwgVG9wQmFyLCB7CiAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDEsIDApLAogICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMjAsIDAsIDApLAogICAgVGV4dENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9UZXh0LAogICAgRm9udCA9IENvbmZpZ3NfSFVCLlRleHRfRm9udCwKICAgIFRleHRYQWxpZ25tZW50ID0gIkxlZnQiLAogICAgVGV4dCA9IHRpdGxlLAogICAgVGV4dFNpemUgPSAyMCwKICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgfSkKICAKICBsb2NhbCBNaW5pbWl6ZV9CVE4gPSBDcmVhdGUoIlRleHRCdXR0b24iLCBCdXR0b25zRnJhbWUsIHsKICAgIFRleHQgPSAiLSIsCiAgICBUZXh0Q29sb3IzID0gQ29uZmlnc19IVUIuQ29yX1RleHQsCiAgICBTaXplID0gVURpbTIubmV3KDAuNSwgMCwgMSwgMCksCiAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMSwKICAgIEZvbnQgPSBDb25maWdzX0hVQi5UZXh0X0ZvbnQsCiAgICBUZXh0WUFsaWdubWVudCA9ICJCb3R0b20iLAogICAgVGV4dFNpemUgPSAyNQogIH0pCiAgCiAgSXNNaW5pbWl6ZWQgPSBmYWxzZQogIE1pbmltaXplX0JUTi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgIE1pbmltaXplX0JUTi5UZXh0ID0gbm90IElzTWluaW1pemVkIGFuZCAiKyIgb3IgIi0iCiAgICBpZiBJc01pbmltaXplZCB0aGVuCiAgICAgIElzTWluaW1pemVkID0gZmFsc2UKICAgICAgQ3JlYXRlVHdlZW4oTWVudSwgIlNpemUiLCBVRGltMi5uZXcoMCwgNTAwLCAwLCAyNzApLCAwLjE1LCBmYWxzZSkKICAgIGVsc2UKICAgICAgSXNNaW5pbWl6ZWQgPSB0cnVlCiAgICAgIENyZWF0ZVR3ZWVuKE1lbnUsICJTaXplIiwgVURpbTIubmV3KDAsIDUwMCwgMCwgMjUpLCAwLjE1LCB0cnVlKQogICAgZW5kCiAgZW5kKQogIAogIGxvY2FsIENsb3NlX0J1dHRvbiA9IENyZWF0ZSgiVGV4dEJ1dHRvbiIsIEJ1dHRvbnNGcmFtZSwgewogICAgVGV4dCA9ICLDlyIsCiAgICBUZXh0WUFsaWdubWVudCA9ICJCb3R0b20iLAogICAgVGV4dENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9UZXh0LAogICAgU2l6ZSA9IFVEaW0yLm5ldygwLjUsIDAsIDEsIDApLAogICAgQW5jaG9yUG9pbnQgPSBWZWN0b3IyLm5ldygxLCAwKSwKICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDEsIDAsIDAsIDApLAogICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEsCiAgICBGb250ID0gQ29uZmlnc19IVUIuVGV4dF9Gb250LAogICAgVGV4dFNpemUgPSAyNQogIH0pCiAgCiAgbG9jYWwgZnVuY3Rpb24gQ3JlYXRlQ2xvc2UoKQogICAgSXNNaW5pbWl6ZWQgPSBmYWxzZQogICAgQ3JlYXRlVHdlZW4oTWVudSwgIlNpemUiLCBVRGltMi5uZXcoMCwgNTAwLCAwLCAyNzApLCAwLjMsIGZhbHNlKQogICAgbG9jYWwgQ2xvc2VHdWkgPSBDcmVhdGUoIlRleHRCdXR0b24iLCBNZW51LCB7CiAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwLjUsCiAgICAgIEJhY2tncm91bmRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfSHViLAogICAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDEsIDApLAogICAgICBBdXRvQnV0dG9uQ29sb3IgPSBmYWxzZSwKICAgICAgVGV4dCA9ICIiLAogICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMC41LAogICAgICBWaXNpYmxlID0gZmFsc2UKICAgIH0pQ29ybmVyKENsb3NlR3VpKQogICAgCiAgICBsb2NhbCBDbG9zZU1lbnUgPSBDcmVhdGUoIkZyYW1lIiwgQ2xvc2VHdWksIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygpLAogICAgICBBbmNob3JQb2ludCA9IFZlY3RvcjIubmV3KDAuNSwgMC41KSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMC41LCAwLCAwLjUsIDApLAogICAgICBUcmFuc3BhcmVuY3kgPSAxLAogICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29uZmlnc19IVUIuQ29yX0h1YgogICAgfSlDb3JuZXIoQ2xvc2VNZW51KVN0cm9rZShDbG9zZU1lbnUpCiAgICAKICAgIGxvY2FsIE1lbnNhZ2UgPSBDcmVhdGUoIlRleHRMYWJlbCIsIENsb3NlTWVudSwgewogICAgICBTaXplID0gVURpbTIubmV3KDAuOCwgMCwgMC4yNSwgMCksCiAgICAgIFRleHQgPSAiQkFOIENPIENIQUMgTVVPTiBET05HIFNDUklQVCBUSElXTiBUSEFIIEhVQiBDSFU/PyIsCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAuMSwgMCwgMC4yKSwKICAgICAgVGV4dENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9UZXh0LAogICAgICBGb250ID0gQ29uZmlnc19IVUIuVGV4dF9Gb250LAogICAgICBUZXh0U2NhbGVkID0gdHJ1ZSwKICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgIH0pCiAgICAKICAgIGxvY2FsIENvbmZpcm0gPSBDcmVhdGUoIlRleHRCdXR0b24iLCBDbG9zZU1lbnUsIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLjM1LCAwLCAwLjMsIDApLAogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLjEsIDAsIDAuNSwgMCksCiAgICAgIEJhY2tncm91bmRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfSHViLAogICAgICBUZXh0ID0gIkRPTkcgU0NSSVBUIiwKICAgICAgRm9udCA9IENvbmZpZ3NfSFVCLlRleHRfRm9udCwKICAgICAgVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI0MCwgMCwgMCksCiAgICAgIFRleHRTaXplID0gMjAKICAgIH0pQ29ybmVyKENvbmZpcm0pU3Ryb2tlKENvbmZpcm0pCiAgICAKICAgIGxvY2FsIENhbmNlbCA9IENyZWF0ZSgiVGV4dEJ1dHRvbiIsIENsb3NlTWVudSwgewogICAgICBTaXplID0gVURpbTIubmV3KDAuMzUsIDAsIDAuMywgMCksCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAuOSwgMCwgMC41LCAwKSwKICAgICAgQW5jaG9yUG9pbnQgPSBWZWN0b3IyLm5ldygxLCAwKSwKICAgICAgQmFja2dyb3VuZENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9IdWIsCiAgICAgIFRleHQgPSAiSFVZIEJPIiwKICAgICAgRm9udCA9IENvbmZpZ3NfSFVCLlRleHRfRm9udCwKICAgICAgVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDAsIDI0MCwgMCksCiAgICAgIFRleHRTaXplID0gMjAKICAgIH0pQ29ybmVyKENhbmNlbClTdHJva2UoQ2FuY2VsKQogICAgCiAgICBsb2NhbCBmdW5jdGlvbiBTZXRWaXNpYmxlKCkKICAgICAgaWYgTWVudS5TaXplLlkuT2Zmc2V0ID4gMTAwIHRoZW4KICAgICAgICBDbG9zZUd1aS5WaXNpYmxlID0gdHJ1ZQogICAgICBlbHNlCiAgICAgICAgQ2xvc2VHdWkuVmlzaWJsZSA9IGZhbHNlCiAgICAgIGVuZAogICAgZW5kCiAgICAKICAgIFNldFZpc2libGUoKQogICAgTWVudTpHZXRQcm9wZXJ0eUNoYW5nZWRTaWduYWwoIlNpemUiKTpDb25uZWN0KFNldFZpc2libGUpCiAgICAKICAgIENyZWF0ZVR3ZWVuKENsb3NlTWVudSwgIlRyYW5zcGFyZW5jeSIsIDAsIDAuMiwgZmFsc2UpCiAgICBDcmVhdGVUd2VlbihDbG9zZU1lbnUsICJTaXplIiwgVURpbTIubmV3KDAuNywgMCwgMC43LCAwKSwgMC4yLCBmYWxzZSkKICAgIAogICAgQ2FuY2VsLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICBDcmVhdGVUd2VlbihDbG9zZU1lbnUsICJUcmFuc3BhcmVuY3kiLCAxLCAwLjMsIGZhbHNlKQogICAgICBDcmVhdGVUd2VlbihDbG9zZU1lbnUsICJTaXplIiwgVURpbTIubmV3KCksIDAuMiwgdHJ1ZSkKICAgICAgQ2xvc2VHdWk6RGVzdHJveSgpCiAgICBlbmQpCiAgICAKICAgIENvbmZpcm0uTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgIENsb3NlR3VpOkRlc3Ryb3koKQogICAgICBDcmVhdGVUd2VlbihNZW51LCAiU2l6ZSIsIFVEaW0yLm5ldygpLCAwLjMsIHRydWUpCiAgICAgIERlc3Ryb3lTY3JpcHQoKQogICAgZW5kKQogICAgCiAgICBDbG9zZUd1aS5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgQ3JlYXRlVHdlZW4oQ2xvc2VNZW51LCAiVHJhbnNwYXJlbmN5IiwgMSwgMC4zLCBmYWxzZSkKICAgICAgQ3JlYXRlVHdlZW4oQ2xvc2VNZW51LCAiU2l6ZSIsIFVEaW0yLm5ldygpLCAwLjIsIHRydWUpCiAgICAgIENsb3NlR3VpOkRlc3Ryb3koKQogICAgZW5kKQogIGVuZAogIAogIENsb3NlX0J1dHRvbi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KENyZWF0ZUNsb3NlKQogIAogIGxvY2FsIEFuaW1NZW51ID0gQ3JlYXRlKCJGcmFtZSIsIFNjcmVlbkd1aSwgewogICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMC41LCAwLCAwLjUsIDApLAogICAgQW5jaG9yUG9pbnQgPSBWZWN0b3IyLm5ldygwLjUsIDAuNSksCiAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29uZmlnc19IVUIuQ29yX0h1YgogIH0pQ29ybmVyKEFuaW1NZW51LCB7Q29ybmVyUmFkaXVzID0gVURpbS5uZXcoMCwgNil9KQogIAogIGxvY2FsIEFuaW1fQ3JlZGl0cyA9IENyZWF0ZSgiVGV4dExhYmVsIiwgQW5pbU1lbnUsIHsKICAgIFRleHQgPSBBbmltX1RpdGxlLAogICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEsCiAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDEsIDApLAogICAgVmlzaWJsZSA9IGZhbHNlLAogICAgRm9udCA9IENvbmZpZ3NfSFVCLlRleHRfRm9udCwKICAgIFRleHRUcmFuc3BhcmVuY3kgPSAxLAogICAgVGV4dENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9UZXh0LAogICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMTAsIDAsIDApLAogICAgVGV4dFhBbGlnbm1lbnQgPSAiTGVmdCIsCiAgICBUZXh0U2l6ZSA9IDE1CiAgfSkKICAKICBDcmVhdGVUd2VlbihBbmltTWVudSwgIlNpemUiLCBVRGltMi5uZXcoMCwgMCwgMCwgMzUpLCAwLjUsIHRydWUpCiAgQ3JlYXRlVHdlZW4oQW5pbU1lbnUsICJTaXplIiwgVURpbTIubmV3KDAsIDE1MCwgMCwgMzUpLCAwLjUsIHRydWUpCiAgQW5pbV9DcmVkaXRzLlZpc2libGUgPSB0cnVlCiAgdGFzay53YWl0KDAuNSkKICBmb3IgaSA9IDEsIDAsIC0wLjEgZG8gdGFzay53YWl0KCkKICAgIEFuaW1fQ3JlZGl0cy5UZXh0VHJhbnNwYXJlbmN5ID0gaQogIGVuZAogIHRhc2sud2FpdCgxKQogIGZvciBpID0gMCwgMSwgMC4xIGRvIHRhc2sud2FpdCgpCiAgICBBbmltX0NyZWRpdHMuVGV4dFRyYW5zcGFyZW5jeSA9IGkKICBlbmQKICBBbmltX0NyZWRpdHM6RGVzdHJveSgpCiAgQW5pbU1lbnU6RGVzdHJveSgpCiAgQ3JlYXRlVHdlZW4oTWVudSwgIlNpemUiLCBVRGltMi5uZXcoMCwgNTAwLCAwLCAzNSksIDAuNSwgdHJ1ZSkKICBUb3BCYXIuVmlzaWJsZSA9IHRydWUKICBDcmVhdGVUd2VlbihNZW51LCAiU2l6ZSIsIFVEaW0yLm5ldygwLCA1MDAsIDAsIDI3MCksIDAuMywgdHJ1ZSkKICBNZW51LkRyYWdnYWJsZSA9IHRydWUKICAKICBsb2NhbCBsaW5lX0NvbnRhaW5lcnMgPSBDcmVhdGUoIkZyYW1lIiwgTWVudSwgewogICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEsCiAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDEsIDApCiAgfSkKICAKICBmdW5jdGlvbiBNaW5pbWl6ZUJ1dHRvbihDb25maWdzKQogICAgbG9jYWwgaW1hZ2UgPSBDb25maWdzLkltYWdlIG9yICIiCiAgICBsb2NhbCBzaXplID0gQ29uZmlncy5TaXplIG9yIHszMCwgMzB9CiAgICBsb2NhbCBjb2xvciA9IENvbmZpZ3MuQ29sb3Igb3IgQ29uZmlnc19IVUIuQ29yX0h1YgogICAgbG9jYWwgY29ybmVyID0gQ29uZmlncy5Db3JuZXIgb3IgdHJ1ZQogICAgbG9jYWwgc3Ryb2tlID0gQ29uZmlncy5TdHJva2Ugb3IgZmFsc2UKICAgIGxvY2FsIHN0cm9rZWNvbG9yID0gQ29uZmlncy5TdHJva2VDb2xvciBvciBDb25maWdzX0hVQi5Db3JfU3Ryb2tlCiAgICAKICAgIGxvY2FsIEJ1dHRvbiA9IENyZWF0ZSgiSW1hZ2VCdXR0b24iLCBTY3JlZW5HdWksIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCBzaXplWzFdLCAwLCBzaXplWzJdKSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMC4xNSwgMCwgMC4xNSwgMCksCiAgICAgIEJhY2tncm91bmRDb2xvcjMgPSBjb2xvciwKICAgICAgSW1hZ2UgPSBpbWFnZSwKICAgICAgQWN0aXZlID0gdHJ1ZSwKICAgICAgRHJhZ2dhYmxlID0gdHJ1ZQogICAgfSlpZiBjb3JuZXIgdGhlbiBDb3JuZXIoQnV0dG9uKSBlbmQgaWYgc3Ryb2tlIHRoZW4gU3Ryb2tlKEJ1dHRvbiwge0NvbG9yID0gc3Ryb2tlY29sb3J9KSBlbmQKICAgIAogICAgbG9jYWwgbWluaW1pemUgPSBmYWxzZQogICAgQnV0dG9uLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICBpZiBtaW5pbWl6ZSB0aGVuCiAgICAgICAgbWluaW1pemUgPSBmYWxzZQogICAgICAgIE1lbnUuVmlzaWJsZSA9IHRydWUKICAgICAgICBpZiBub3QgSXNNaW5pbWl6ZWQgdGhlbgogICAgICAgICAgQ3JlYXRlVHdlZW4oTWVudSwgIlNpemUiLCBVRGltMi5uZXcoMCwgNTAwLCAwLCAyNzApLCAwLjMsIGZhbHNlKQogICAgICAgIGVsc2UKICAgICAgICAgIENyZWF0ZVR3ZWVuKE1lbnUsICJTaXplIiwgVURpbTIubmV3KDAsIDUwMCwgMCwgMjUpLCAwLjMsIGZhbHNlKQogICAgICAgIGVuZAogICAgICBlbHNlCiAgICAgICAgbWluaW1pemUgPSB0cnVlCiAgICAgICAgQ3JlYXRlVHdlZW4oTWVudSwgIlNpemUiLCBVRGltMi5uZXcoMCwgNTAwLCAwLCAwKSwgMC4zLCB0cnVlKQogICAgICAgIE1lbnUuVmlzaWJsZSA9IGZhbHNlCiAgICAgIGVuZAogICAgZW5kKQogIGVuZAogIAogIGxvY2FsIFNjcm9sbEJhciA9IENyZWF0ZSgiU2Nyb2xsaW5nRnJhbWUiLCBNZW51LCB7CiAgICBTaXplID0gVURpbTIubmV3KDAsIDE0MCwgMSwgLXRvbnVtYmVyKFRvcEJhci5TaXplLlkuT2Zmc2V0ICsgMikpLAogICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMCwgMSwgMCksCiAgICBBbmNob3JQb2ludCA9IFZlY3RvcjIubmV3KDAsIDEpLAogICAgQ2FudmFzU2l6ZSA9IFVEaW0yLm5ldygpLAogICAgU2Nyb2xsaW5nRGlyZWN0aW9uID0gIlkiLAogICAgQXV0b21hdGljQ2FudmFzU2l6ZSA9ICJZIiwKICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxLAogICAgU2Nyb2xsQmFyVGhpY2tuZXNzID0gMgogIH0pQ3JlYXRlKCJVSVBhZGRpbmciLCBTY3JvbGxCYXIsIHsKICAgIFBhZGRpbmdMZWZ0ID0gVURpbS5uZXcoMCwgMTApLAogICAgUGFkZGluZ1JpZ2h0ID0gVURpbS5uZXcoMCwgMTApLAogICAgUGFkZGluZ1RvcCA9IFVEaW0ubmV3KDAsIDEwKSwKICAgIFBhZGRpbmdCb3R0b20gPSBVRGltLm5ldygwLCAxMCkKICB9KUNyZWF0ZSgiVUlMaXN0TGF5b3V0IiwgU2Nyb2xsQmFyLCB7CiAgICBQYWRkaW5nID0gVURpbS5uZXcoMCwgNSkKICB9KQogIAogIGxvY2FsIENvbnRhaW5lcnMgPSBDcmVhdGUoIkZyYW1lIiwgTWVudSwgewogICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAtdG9udW1iZXIoU2Nyb2xsQmFyLlNpemUuWC5PZmZzZXQgKyAyKSwgMSwgLXRvbnVtYmVyKFRvcEJhci5TaXplLlkuT2Zmc2V0ICsgMikpLAogICAgQW5jaG9yUG9pbnQgPSBWZWN0b3IyLm5ldygxLCAxKSwKICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDEsIDAsIDEsIDApLAogICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICB9KUNvcm5lcihDb250YWluZXJzKQogIAogIGxvY2FsIGZ1bmN0aW9uIEFkZF9MaW5lKHByb3BzKQogICAgbG9jYWwgbGluZSA9IENyZWF0ZSgiRnJhbWUiLCBsaW5lX0NvbnRhaW5lcnMsIHByb3BzKQogICAgbGluZS5CYWNrZ3JvdW5kQ29sb3IzID0gQ29uZmlnc19IVUIuQ29yX1N0cm9rZQogICAgbGluZS5Cb3JkZXJTaXplUGl4ZWwgPSAwCiAgZW5kCiAgCiAgQWRkX0xpbmUoe1NpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMSksUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMCwgMCwgVG9wQmFyLlNpemUuWS5PZmZzZXQpfSkKICBBZGRfTGluZSh7U2l6ZSA9IFVEaW0yLm5ldygwLCAxLCAxLCAtdG9udW1iZXIoVG9wQmFyLlNpemUuWS5PZmZzZXQgKyAxKSksCiAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgU2Nyb2xsQmFyLlNpemUuWC5PZmZzZXQsIDAsIFRvcEJhci5TaXplLlkuT2Zmc2V0KX0pCiAgCiAgbG9jYWwgZmlyc3RWaXNpYmxlID0gdHJ1ZQogIGxvY2FsIEZpcnN0VGFiID0gdHJ1ZQogIGxvY2FsIHRleHRzaXplID0gMTUKICBsb2NhbCB0ZXh0Y29sb3IgPSBDb25maWdzX0hVQi5Db3JfVGV4dAogIAogIE1lbnU6R2V0UHJvcGVydHlDaGFuZ2VkU2lnbmFsKCJTaXplIik6Q29ubmVjdChmdW5jdGlvbigpCiAgICBpZiBNZW51LlNpemUuWS5PZmZzZXQgPiA3MCB0aGVuCiAgICAgIFNjcm9sbEJhci5WaXNpYmxlID0gdHJ1ZQogICAgICBDb250YWluZXJzLlZpc2libGUgPSB0cnVlCiAgICAgIGxpbmVfQ29udGFpbmVycy5WaXNpYmxlID0gdHJ1ZQogICAgZWxzZQogICAgICBTY3JvbGxCYXIuVmlzaWJsZSA9IGZhbHNlCiAgICAgIENvbnRhaW5lcnMuVmlzaWJsZSA9IGZhbHNlCiAgICAgIGxpbmVfQ29udGFpbmVycy5WaXNpYmxlID0gZmFsc2UKICAgIGVuZAogIGVuZCkKICAKICBmdW5jdGlvbiBNYWtlVGFiKENvbmZpZ3MpCiAgICBsb2NhbCBUYWJOYW1lID0gQ29uZmlncy5OYW1lIG9yICJUYWIiCiAgICBsb2NhbCBUYWJUaXRsZSA9IENvbmZpZ3MuVGFiVGl0bGUgb3IgZmFsc2UKICAgIAogICAgbG9jYWwgRnJhbWUgPSBDcmVhdGUoIkZyYW1lIiwgU2Nyb2xsQmFyLCB7CiAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMjUpLAogICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgfSlDb3JuZXIoRnJhbWUpU3Ryb2tlKEZyYW1lKQogICAgCiAgICBsb2NhbCBUZXh0QnV0dG9uID0gQ3JlYXRlKCJUZXh0QnV0dG9uIiwgRnJhbWUsIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAxLCAwKSwKICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEsCiAgICAgIFRleHQgPSAiIgogICAgfSkKICAgIAogICAgbG9jYWwgVGV4dExhYmVsID0gQ3JlYXRlKCJUZXh0TGFiZWwiLCBGcmFtZSwgewogICAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDEsIDApLAogICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMSwKICAgICAgRm9udCA9IENvbmZpZ3NfSFVCLlRleHRfRm9udCwKICAgICAgVGV4dENvbG9yMyA9IHRleHRjb2xvciwKICAgICAgVGV4dFNpemUgPSB0ZXh0c2l6ZSwKICAgICAgVGV4dCA9IFRhYk5hbWUKICAgIH0pCiAgICAKICAgIGxvY2FsIENvbnRhaW5lciA9IENyZWF0ZSgiU2Nyb2xsaW5nRnJhbWUiLCBDb250YWluZXJzLCB7CiAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMSwgMCksCiAgICAgIFNjcm9sbGluZ0RpcmVjdGlvbiA9ICJZIiwKICAgICAgQXV0b21hdGljQ2FudmFzU2l6ZSA9ICJZIiwKICAgICAgQ2FudmFzU2l6ZSA9IFVEaW0yLm5ldygpLAogICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMSwKICAgICAgU2Nyb2xsQmFyVGhpY2tuZXNzID0gMiwKICAgICAgVmlzaWJsZSA9IGZpcnN0VmlzaWJsZQogICAgfSlDcmVhdGUoIlVJUGFkZGluZyIsIENvbnRhaW5lciwgewogICAgICBQYWRkaW5nTGVmdCA9IFVEaW0ubmV3KDAsIDEwKSwKICAgICAgUGFkZGluZ1JpZ2h0ID0gVURpbS5uZXcoMCwgMTApLAogICAgICBQYWRkaW5nVG9wID0gVURpbS5uZXcoMCwgMTApLAogICAgICBQYWRkaW5nQm90dG9tID0gVURpbS5uZXcoMCwgMTApCiAgICB9KUNyZWF0ZSgiVUlMaXN0TGF5b3V0IiwgQ29udGFpbmVyLCB7CiAgICAgIFBhZGRpbmcgPSBVRGltLm5ldygwLCA1KQogICAgfSkKICAgIAogICAgaWYgVGFiVGl0bGUgdGhlbgogICAgICBDcmVhdGUoIlRleHRMYWJlbCIsQ29udGFpbmVyLHtCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5PTEsVGV4dD0iIyIuLnN0cmluZy5nc3ViKFRhYk5hbWUsIiAiLCItIiksVGV4dFNpemU9MjUsRm9udD1Db25maWdzX0hVQi5UZXh0X0ZvbnQsVGV4dFhBbGlnbm1lbnQ9IkxlZnQiLFRleHRDb2xvcjM9Q29uZmlnc19IVUIuQ29yX1RleHQsU2l6ZT1VRGltMi5uZXcoMSwgMCwgMCwgMzApLFBvc2l0aW9uPVVEaW0yLm5ldygwLCAzMCwgMCwgMCksTmFtZT0iRnJhbWUifSkKICAgIGVuZAogICAgCiAgICBUZXh0QnV0dG9uLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICBmb3IgXyxjb250YWluZXIgaW4gcGFpcnMoQ29udGFpbmVyczpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIGlmIGNvbnRhaW5lcjpJc0EoIlNjcm9sbGluZ0ZyYW1lIikgdGhlbgogICAgICAgICAgY29udGFpbmVyLlZpc2libGUgPSBmYWxzZQogICAgICAgIGVuZAogICAgICBlbmQKICAgICAgZm9yIF8sZnJhbWUgaW4gcGFpcnMoU2Nyb2xsQmFyOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgaWYgZnJhbWU6SXNBKCJGcmFtZSIpIGFuZCBmcmFtZTpGaW5kRmlyc3RDaGlsZCgiVGV4dExhYmVsIikgYW5kIGZyYW1lLlRleHRMYWJlbCB+PSBUZXh0TGFiZWwgdGhlbgogICAgICAgICAgQ3JlYXRlVHdlZW4oZnJhbWUuVGV4dExhYmVsLCAiVGV4dENvbG9yMyIsIENvbmZpZ3NfSFVCLkNvcl9EYXJrVGV4dCwgMC4zLCBmYWxzZSkKICAgICAgICAgIGZyYW1lLlRleHRMYWJlbC5UZXh0U2l6ZSA9IDE0CiAgICAgICAgZW5kCiAgICAgIGVuZAogICAgICBDb250YWluZXIuVmlzaWJsZSA9IHRydWUKICAgICAgQ3JlYXRlVHdlZW4oVGV4dExhYmVsLCAiVGV4dENvbG9yMyIsIENvbmZpZ3NfSFVCLkNvcl9UZXh0LCAwLjMsIGZhbHNlKQogICAgICBUZXh0TGFiZWwuVGV4dFNpemUgPSAxNQogICAgZW5kKQogICAgCiAgICBmaXJzdFZpc2libGUgPSBmYWxzZQogICAgRmlyc3RUYWIgPSBmYWxzZQogICAgdGV4dHNpemUgPSAxNAogICAgdGV4dGNvbG9yID0gQ29uZmlnc19IVUIuQ29yX0RhcmtUZXh0CiAgICByZXR1cm4gQ29udGFpbmVyCiAgZW5kCiAgCiAgZnVuY3Rpb24gQWRkQnV0dG9uKHBhcmVudCwgQ29uZmlncykKICAgIGxvY2FsIEJ1dHRvbk5hbWUgPSBDb25maWdzLk5hbWUgb3IgIkJ1dHRvbiEhIgogICAgbG9jYWwgQ2FsbGJhY2sgPSBDb25maWdzLkNhbGxiYWNrIG9yIGZ1bmN0aW9uKCkgZW5kCiAgICAKICAgIGxvY2FsIFRleHRCdXR0b24gPSBDcmVhdGUoIlRleHRCdXR0b24iLCBwYXJlbnQsIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCAyNSksCiAgICAgIEJhY2tncm91bmRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfT3B0aW9ucywKICAgICAgTmFtZSA9ICJGcmFtZSIsCiAgICAgIFRleHQgPSAiIiwKICAgICAgQXV0b0J1dHRvbkNvbG9yID0gZmFsc2UKICAgIH0pQ29ybmVyKFRleHRCdXR0b24pU3Ryb2tlKFRleHRCdXR0b24pCiAgICAKICAgIGxvY2FsIFRleHRMYWJlbCA9IENyZWF0ZSgiVGV4dExhYmVsIiwgVGV4dEJ1dHRvbiwgewogICAgICBUZXh0U2l6ZSA9IDEyLAogICAgICBUZXh0Q29sb3IzID0gQ29uZmlnc19IVUIuQ29yX1RleHQsCiAgICAgIFRleHQgPSBCdXR0b25OYW1lLAogICAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDEsIDApLAogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAzNSwgMCwgMCksCiAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxLAogICAgICBUZXh0WEFsaWdubWVudCA9ICJMZWZ0IiwKICAgICAgRm9udCA9IENvbmZpZ3NfSFVCLlRleHRfRm9udAogICAgfSkKICAgIAogICAgbG9jYWwgSW1hZ2VMYWJlbCA9IENyZWF0ZSgiSW1hZ2VMYWJlbCIsIFRleHRCdXR0b24sIHsKICAgICAgSW1hZ2UgPSAicmJ4YXNzZXRpZDovLzE1MTU1MjE5NDA1IiwKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCAyMCwgMCwgMjApLAogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLCA1LCAwLCAyLjUpLAogICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMSwKICAgICAgSW1hZ2VDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfU3Ryb2tlCiAgICB9KQogICAgCiAgICBUZXh0QnV0dG9uLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICBDYWxsYmFjaygiQ2xpY2shISIpCiAgICAgIENyZWF0ZVR3ZWVuKEltYWdlTGFiZWwsICJJbWFnZUNvbG9yMyIsIENvbG9yMy5mcm9tUkdCKDI4LCAxMjAsIDIxMiksIDAuMiwgdHJ1ZSkKICAgICAgQ3JlYXRlVHdlZW4oSW1hZ2VMYWJlbCwgIkltYWdlQ29sb3IzIiwgQ29uZmlnc19IVUIuQ29yX1N0cm9rZSwgMC4yLCBmYWxzZSkKICAgIGVuZCkKICAgIAogICAgVGV4dFNldENvbG9yKFRleHRMYWJlbCkKICBlbmQKICAKICBmdW5jdGlvbiBBZGRUb2dnbGUocGFyZW50LCBDb25maWdzKQogICAgbG9jYWwgVG9nZ2xlTmFtZSA9IENvbmZpZ3MuTmFtZSBvciAiVG9nZ2xlISEiCiAgICBsb2NhbCBEZWZhdWx0ID0gQ29uZmlncy5EZWZhdWx0IG9yIGZhbHNlCiAgICBsb2NhbCBDYWxsYmFjayA9IENvbmZpZ3MuQ2FsbGJhY2sgb3IgZnVuY3Rpb24oKSBlbmQKICAgIAogICAgbG9jYWwgVGV4dEJ1dHRvbiA9IENyZWF0ZSgiVGV4dEJ1dHRvbiIsIHBhcmVudCwgewogICAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDI1KSwKICAgICAgQmFja2dyb3VuZENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9PcHRpb25zLAogICAgICBOYW1lID0gIkZyYW1lIiwKICAgICAgVGV4dCA9ICIiLAogICAgICBBdXRvQnV0dG9uQ29sb3IgPSBmYWxzZQogICAgfSlDb3JuZXIoVGV4dEJ1dHRvbilTdHJva2UoVGV4dEJ1dHRvbikKICAgIAogICAgbG9jYWwgVGV4dExhYmVsID0gQ3JlYXRlKCJUZXh0TGFiZWwiLCBUZXh0QnV0dG9uLCB7CiAgICAgIFRleHRTaXplID0gMTIsCiAgICAgIFRleHRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfVGV4dCwKICAgICAgVGV4dCA9IFRvZ2dsZU5hbWUsCiAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMSwgMCksCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDM1LCAwLCAwKSwKICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEsCiAgICAgIFRleHRYQWxpZ25tZW50ID0gIkxlZnQiLAogICAgICBGb250ID0gQ29uZmlnc19IVUIuVGV4dF9Gb250CiAgICB9KQogICAgCiAgICBsb2NhbCBGcmFtZTEgPSBDcmVhdGUoIkZyYW1lIiwgVGV4dEJ1dHRvbiwgewogICAgICBTaXplID0gVURpbTIubmV3KDAsIDI1LCAwLCAxNSksCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDUsIDAsIDUpLAogICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMSwKICAgIH0pQ29ybmVyKEZyYW1lMSwge0Nvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDEsIDApfSkKICAgIGxvY2FsIFN0cm9rZSA9IFN0cm9rZShGcmFtZTEsIHtUaGlja25lc3MgPSAyfSkKICAgIAogICAgbG9jYWwgRnJhbWUyID0gQ3JlYXRlKCJGcmFtZSIsIEZyYW1lMSwgewogICAgICBTaXplID0gVURpbTIubmV3KDAsIDEzLCAwLCAxMyksCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDIsIDAuNSwgMCksCiAgICAgIEFuY2hvclBvaW50ID0gVmVjdG9yMi5uZXcoMCwgMC41KSwKICAgICAgQmFja2dyb3VuZENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9TdHJva2UKICAgIH0pQ29ybmVyKEZyYW1lMiwge0Nvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDEsIDApfSkKICAgIAogICAgbG9jYWwgT25PZmYgPSBmYWxzZQogICAgaWYgRGVmYXVsdCB0aGVuCiAgICAgIE9uT2ZmID0gdHJ1ZQogICAgICBDcmVhdGVUd2VlbihGcmFtZTIsICJQb3NpdGlvbiIsIFVEaW0yLm5ldygwLCAxMCwgMC41LCAwKSwgMC4yLCBmYWxzZSkKICAgICAgQ3JlYXRlVHdlZW4oRnJhbWUyLCAiQmFja2dyb3VuZENvbG9yMyIsIENvbG9yMy5mcm9tUkdCKDI4LCAxMjAsIDIxMiksIDAuMiwgZmFsc2UpCiAgICAgIENyZWF0ZVR3ZWVuKFN0cm9rZSwgIkNvbG9yIiwgQ29sb3IzLmZyb21SR0IoMjgsIDEyMCwgMjEyKSwgMC4yLCBmYWxzZSkKICAgICAgQ3JlYXRlVHdlZW4oVGV4dExhYmVsLCAiVGV4dENvbG9yMyIsIENvbG9yMy5mcm9tUkdCKDI4LCAxMjAsIDIxMiksIDAuMiwgZmFsc2UpCiAgICBlbmQKICAgIENhbGxiYWNrKE9uT2ZmKQogICAgVGV4dEJ1dHRvbi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgaWYgRnJhbWUyLlBvc2l0aW9uLlguT2Zmc2V0IDwgNSB0aGVuCiAgICAgICAgT25PZmYgPSB0cnVlCiAgICAgICAgQ3JlYXRlVHdlZW4oRnJhbWUyLCAiUG9zaXRpb24iLCBVRGltMi5uZXcoMCwgMTAsIDAuNSwgMCksIDAuMiwgZmFsc2UpCiAgICAgICAgQ3JlYXRlVHdlZW4oRnJhbWUyLCAiQmFja2dyb3VuZENvbG9yMyIsIENvbG9yMy5mcm9tUkdCKDI4LCAxMjAsIDIxMiksIDAuMiwgZmFsc2UpCiAgICAgICAgQ3JlYXRlVHdlZW4oU3Ryb2tlLCAiQ29sb3IiLCBDb2xvcjMuZnJvbVJHQigyOCwgMTIwLCAyMTIpLCAwLjIsIGZhbHNlKQogICAgICAgIENyZWF0ZVR3ZWVuKFRleHRMYWJlbCwgIlRleHRDb2xvcjMiLCBDb2xvcjMuZnJvbVJHQigyOCwgMTIwLCAyMTIpLCAwLjIsIGZhbHNlKQogICAgICAgIENhbGxiYWNrKHRydWUpCiAgICAgIGVsc2UKICAgICAgICBPbk9mZiA9IGZhbHNlCiAgICAgICAgQ3JlYXRlVHdlZW4oRnJhbWUyLCAiUG9zaXRpb24iLCBVRGltMi5uZXcoMCwgMiwgMC41LCAwKSwgMC4yLCBmYWxzZSkKICAgICAgICBDcmVhdGVUd2VlbihGcmFtZTIsICJCYWNrZ3JvdW5kQ29sb3IzIiwgQ29uZmlnc19IVUIuQ29yX1N0cm9rZSwgMC4yLCBmYWxzZSkKICAgICAgICBDcmVhdGVUd2VlbihTdHJva2UsICJDb2xvciIsIENvbmZpZ3NfSFVCLkNvcl9TdHJva2UsIDAuMiwgZmFsc2UpCiAgICAgICAgQ3JlYXRlVHdlZW4oVGV4dExhYmVsLCAiVGV4dENvbG9yMyIsIENvbmZpZ3NfSFVCLkNvcl9UZXh0LCAwLjIsIGZhbHNlKQogICAgICAgIENhbGxiYWNrKGZhbHNlKQogICAgICBlbmQKICAgIGVuZCkKICAgIHJldHVybiB7RnJhbWUyLCBTdHJva2UsIE9uT2ZmLCBDYWxsYmFja30KICBlbmQKICAKICBmdW5jdGlvbiBBZGRNb2JpbGVUb2dnbGUoQ29uZmlncykKICAgIGxvY2FsIG5hbWUgPSBDb25maWdzLk5hbWUgb3IgIkF0YWxobyIKICAgIGxvY2FsIENhbGxiYWNrID0gQ29uZmlncy5DYWxsYmFjayBvciBmdW5jdGlvbigpIGVuZAogICAgbG9jYWwgdmlzaWJsZSA9IENvbmZpZ3MuVmlzaWJsZSBvciBmYWxzZQogICAgCiAgICBsb2NhbCBUb2dnbGVfQXRhbGhvID0gQ3JlYXRlKCJGcmFtZSIsIFNjcmVlbkd1aSwgewogICAgICBTaXplID0gVURpbTIubmV3KDAsIDEwMCwgMCwgNjApLAogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLjgsIDAsIDAuOCwgMCksCiAgICAgIEFuY2hvclBvaW50ID0gVmVjdG9yMi5uZXcoMC41LCAwLjUpLAogICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29uZmlnc19IVUIuQ29yX0h1YiwKICAgICAgRHJhZ2dhYmxlID0gdHJ1ZSwKICAgICAgQWN0aXZlID0gdHJ1ZSwKICAgICAgVmlzaWJsZSA9IHZpc2libGUKICAgIH0pQ29ybmVyKFRvZ2dsZV9BdGFsaG8pCiAgICAKICAgIGxvY2FsIFRleHRMYWJlbCA9IENyZWF0ZSgiVGV4dExhYmVsIiwgVG9nZ2xlX0F0YWxobywgewogICAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDIwKSwKICAgICAgVGV4dFNpemUgPSAyMCwKICAgICAgRm9udCA9IENvbmZpZ3NfSFVCLlRleHRfRm9udCwKICAgICAgVGV4dENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9UZXh0LAogICAgICBUZXh0ID0gbmFtZSwKICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgIH0pCiAgICAKICAgIGxvY2FsIEJ1dHRvbiA9IENyZWF0ZSgiVGV4dEJ1dHRvbiIsIFRvZ2dsZV9BdGFsaG8sIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCA0MCksCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDAsIDAsIDIwKSwKICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEsCiAgICAgIFRleHQgPSAiIgogICAgfSkKICAgIAogICAgbG9jYWwgRnJhbWUgPSBDcmVhdGUoIkZyYW1lIiwgQnV0dG9uLCB7CiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAuNSwgMCwgMC41LCAwKSwKICAgICAgQW5jaG9yUG9pbnQgPSBWZWN0b3IyLm5ldygwLjUsIDAuNSksCiAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgLTQwLCAxLCAtMTUpLAogICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgfSlDb3JuZXIoRnJhbWUsIHtDb3JuZXJSYWRpdXMgPSBVRGltLm5ldygyLCAwKX0pCiAgICAKICAgIGxvY2FsIEZyYW1lMiA9IENyZWF0ZSgiRnJhbWUiLCBGcmFtZSwgewogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLCA1LCAwLjUsIDApLAogICAgICBBbmNob3JQb2ludCA9IFZlY3RvcjIubmV3KDAsIDAuNSksCiAgICAgIFNpemUgPSBVRGltMi5uZXcoMCwgMTcsIDAsIDE3KSwKICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgIH0pQ29ybmVyKEZyYW1lMiwge0Nvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDUsIDApfSkKICAgIAogICAgbG9jYWwgc3Ryb2tlID0gU3Ryb2tlKEZyYW1lLCB7CiAgICAgIENvbG9yID0gQ29sb3IzLmZyb21SR0IoMTAwLCAxMDAsIDEwMCksCiAgICAgIFRoaWNrbmVzcyA9IDMKICAgIH0pCiAgICAKICAgIGxvY2FsIHN0cm9rZSA9IFN0cm9rZShGcmFtZTIsIHsKICAgICAgQ29sb3IgPSBDb2xvcjMuZnJvbVJHQigxMDAsIDEwMCwgMTAwKSwKICAgICAgVGhpY2tuZXNzID0gMwogICAgfSkKICAgIAogICAgbG9jYWwgT25PZmYgPSBmYWxzZQogICAgQ2FsbGJhY2soT25PZmYpCiAgICBCdXR0b24uTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgIGlmIE9uT2ZmID09IGZhbHNlIHRoZW4KICAgICAgICBDcmVhdGVUd2VlbihGcmFtZTIsICJQb3NpdGlvbiIsIFVEaW0yLm5ldygxLCAtMjIsIDAuNSwgMCksIDAuMiwgZmFsc2UpCiAgICAgIGVsc2UKICAgICAgICBDcmVhdGVUd2VlbihGcmFtZTIsICJQb3NpdGlvbiIsIFVEaW0yLm5ldygwLCA1LCAwLjUsIDApLCAwLjIsIGZhbHNlKQogICAgICBlbmQKICAgICAgT25PZmYgPSBub3QgT25PZmYKICAgICAgQ2FsbGJhY2soT25PZmYpCiAgICBlbmQpCiAgICAKICAgIHJldHVybiBUb2dnbGVfQXRhbGhvCiAgZW5kCiAgCiAgZnVuY3Rpb24gVXBkYXRlVG9nZ2xlKHRvZ2dsZSwgdmFsdWUpCiAgICBsb2NhbCBGcmFtZTIgPSB0b2dnbGVbMV0KICAgIGxvY2FsIFN0cm9rZSA9IHRvZ2dsZVsyXQogICAgbG9jYWwgT25PZmYgPSB2YWx1ZQogICAgbG9jYWwgQ2FsbGJhY2sgPSB0b2dnbGVbNF0KICAgIAogICAgaWYgT25PZmYgdGhlbgogICAgICBDYWxsYmFjayh0cnVlKQogICAgICBDcmVhdGVUd2VlbihGcmFtZTIsICJQb3NpdGlvbiIsIFVEaW0yLm5ldygwLCAxMCwgMC41LCAwKSwgMC4yLCBmYWxzZSkKICAgICAgQ3JlYXRlVHdlZW4oRnJhbWUyLCAiQmFja2dyb3VuZENvbG9yMyIsIENvbG9yMy5mcm9tUkdCKDI4LCAxMjAsIDIxMiksIDAuMiwgZmFsc2UpCiAgICAgIENyZWF0ZVR3ZWVuKFN0cm9rZSwgIkNvbG9yIiwgQ29sb3IzLmZyb21SR0IoMjgsIDEyMCwgMjEyKSwgMC4yLCBmYWxzZSkKICAgICAgQ3JlYXRlVHdlZW4oVGV4dExhYmVsLCAiVGV4dENvbG9yMyIsIENvbG9yMy5mcm9tUkdCKDI4LCAxMjAsIDIxMiksIDAuMiwgZmFsc2UpCiAgICBlbHNlCiAgICAgIENhbGxiYWNrKGZhbHNlKQogICAgICBDcmVhdGVUd2VlbihGcmFtZTIsICJQb3NpdGlvbiIsIFVEaW0yLm5ldygwLCAyLCAwLjUsIDApLCAwLjIsIGZhbHNlKQogICAgICBDcmVhdGVUd2VlbihGcmFtZTIsICJCYWNrZ3JvdW5kQ29sb3IzIiwgQ29uZmlnc19IVUIuQ29yX1N0cm9rZSwgMC4yLCBmYWxzZSkKICAgICAgQ3JlYXRlVHdlZW4oU3Ryb2tlLCAiQ29sb3IiLCBDb25maWdzX0hVQi5Db3JfU3Ryb2tlLCAwLjIsIGZhbHNlKQogICAgICBDcmVhdGVUd2VlbihUZXh0TGFiZWwsICJUZXh0Q29sb3IzIiwgQ29uZmlnc19IVUIuQ29yX1RleHQsIDAuMiwgZmFsc2UpCiAgICBlbmQKICBlbmQKICAKICBmdW5jdGlvbiBBZGRTbGlkZXIocGFyZW50LCBDb25maWdzKQogICAgbG9jYWwgU2xpZGVyTmFtZSA9IENvbmZpZ3MuTmFtZSBvciAiU2xpZGVyISEiCiAgICBsb2NhbCBJbmNyZWFzZSA9IENvbmZpZ3MuSW5jcmVhc2Ugb3IgMQogICAgbG9jYWwgTWluVmFsdWUgPSBDb25maWdzLk1pblZhbHVlIC8gSW5jcmVhc2Ugb3IgMTAgLyBJbmNyZWFzZQogICAgbG9jYWwgTWF4VmFsdWUgPSBDb25maWdzLk1heFZhbHVlIC8gSW5jcmVhc2Ugb3IgMTAwIC8gSW5jcmVhc2UKICAgIGxvY2FsIERlZmF1bHQgPSBDb25maWdzLkRlZmF1bHQgb3IgMjUKICAgIGxvY2FsIENhbGxiYWNrID0gQ29uZmlncy5DYWxsYmFjayBvciBmdW5jdGlvbigpIGVuZAogICAgCiAgICBsb2NhbCBGcmFtZSA9IENyZWF0ZSgiVGV4dEJ1dHRvbiIsIHBhcmVudCwgewogICAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDI1KSwKICAgICAgQmFja2dyb3VuZENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9PcHRpb25zLAogICAgICBOYW1lID0gIkZyYW1lIiwKICAgICAgVGV4dCA9IDAKICAgIH0pQ29ybmVyKEZyYW1lKVN0cm9rZShGcmFtZSkKICAgIAogICAgbG9jYWwgVGV4dExhYmVsID0gQ3JlYXRlKCJUZXh0QnV0dG9uIiwgRnJhbWUsIHsKICAgICAgVGV4dFNpemUgPSAxMiwKICAgICAgVGV4dENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9UZXh0LAogICAgICBUZXh0ID0gU2xpZGVyTmFtZSwKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAxLCAwKSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMTUwLCAwLCAwKSwKICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEsCiAgICAgIFRleHRYQWxpZ25tZW50ID0gIkxlZnQiLAogICAgICBGb250ID0gQ29uZmlnc19IVUIuVGV4dF9Gb250CiAgICB9KVRleHRTZXRDb2xvcihUZXh0TGFiZWwpCiAgICAKICAgIGxvY2FsIFRleHRMYWJlbE51bWJlciA9IENyZWF0ZSgiVGV4dExhYmVsIiwgRnJhbWUsIHsKICAgICAgRm9udCA9IENvbmZpZ3NfSFVCLlRleHRfRm9udCwKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCAyMCwgMCwgMjApLAogICAgICBUZXh0ID0gIi4uLiIsCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDUsIDAsIDIuNSksCiAgICAgIFRleHRTY2FsZWQgPSB0cnVlLAogICAgICBUZXh0Q29sb3IzID0gQ29uZmlnc19IVUIuQ29yX1RleHQsCiAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICB9KQogICAgCiAgICBsb2NhbCBTbGlkZXJCYXIxID0gQ3JlYXRlKCJUZXh0TGFiZWwiLCBGcmFtZSwgewogICAgICBTaXplID0gVURpbTIubmV3KDAsIDEwMCwgMCwgNy41KSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMzUsIDAuNSwgMCksCiAgICAgIEFuY2hvclBvaW50ID0gVmVjdG9yMi5uZXcoMCwgMC41KSwKICAgICAgQmFja2dyb3VuZENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9TdHJva2UsCiAgICAgIFRleHQgPSAiIgogICAgfSlDb3JuZXIoU2xpZGVyQmFyMSkKICAgIAogICAgbG9jYWwgU2F2ZVBvcyA9IENyZWF0ZSgiRnJhbWUiLCBTbGlkZXJCYXIxLCB7CiAgICAgIFNpemUgPSBVRGltMi5uZXcoMCwgMSwgMCwgMCksCiAgICAgIFZpc2libGUgPSBmYWxzZQogICAgfSkKICAgIAogICAgbG9jYWwgU2xpZGVyID0gQ3JlYXRlKCJGcmFtZSIsIFNsaWRlckJhcjEsIHsKICAgICAgQmFja2dyb3VuZENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9UZXh0LAogICAgICBTaXplID0gVURpbTIubmV3KDAsIDcuNSwgMCwgMTUpLAogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAwLCAwLjUsIDApLAogICAgICBBbmNob3JQb2ludCA9IFZlY3RvcjIubmV3KDAsIDAuNSksCiAgICAgIEFjdGl2ZSA9IHRydWUsCiAgICAgIERyYWdnYWJsZSA9IHRydWUKICAgIH0pQ29ybmVyKFNsaWRlcikKICAgIAogICAgbG9jYWwgU2xpZGVyQmFyMiA9IENyZWF0ZSgiRnJhbWUiLCBTbGlkZXJCYXIxLCB7CiAgICAgIEJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyOCwgMTIwLCAyMTIpLAogICAgICBTaXplID0gVURpbTIubmV3KDAsIFNsaWRlci5Qb3NpdGlvbi5YLk9mZnNldCwgMSwgMCkKICAgIH0pQ29ybmVyKFNsaWRlckJhcjIpCiAgICAKICAgIGxvY2FsIGZ1bmN0aW9uIFVwZENvdW50ZXIoVmFsdWUpCiAgICAgIGxvY2FsIFN0cmluZyA9IHRvc3RyaW5nKFZhbHVlICogSW5jcmVhc2UpCiAgICAgIGlmIHN0cmluZy5maW5kKFN0cmluZywgIi4iKSB0aGVuCiAgICAgICAgU3RyaW5nID0gU3RyaW5nOnN1YigxLCA1KQogICAgICBlbmQKICAgICAgVGV4dExhYmVsTnVtYmVyLlRleHQgPSBTdHJpbmcKICAgICAgQ2FsbGJhY2soVmFsdWUgKiBJbmNyZWFzZSkKICAgIGVuZAogICAgCiAgICBsb2NhbCBNb3VzZUVudGVyT3JMZWF2ZSA9IGZhbHNlCiAgICBGcmFtZS5Nb3VzZUJ1dHRvbjFEb3duOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICBNb3VzZUVudGVyT3JMZWF2ZSA9IHRydWUKICAgICAgd2hpbGUgTW91c2VFbnRlck9yTGVhdmUgZG8gdGFzay53YWl0KCkKICAgICAgICBsb2NhbCBNb3VzZVBvcyA9IFVzZXJJbnB1dFNlcnZpY2U6R2V0TW91c2VMb2NhdGlvbigpLlggLSBTYXZlUG9zLkFic29sdXRlUG9zaXRpb24uWAogICAgICAgIFNsaWRlci5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLCBNb3VzZVBvcywgMC41LCAwKQogICAgICBlbmQKICAgIGVuZCkKICAgIEZyYW1lLk1vdXNlTGVhdmU6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgIE1vdXNlRW50ZXJPckxlYXZlID0gZmFsc2UKICAgIGVuZCkKICAgIAogICAgbG9jYWwgZnVuY3Rpb24gU2xpZGVyU2V0KE5ld1ZhbHVlKQogICAgICBsb2NhbCBtYXgsIG1pbiA9IE1heFZhbHVlICogSW5jcmVhc2UsIE1pblZhbHVlICogSW5jcmVhc2UKICAgICAgbG9jYWwgU2xpZGVyUG9zID0gKE5ld1ZhbHVlIC0gbWluKSAvIChtYXggLSBtaW4pCiAgICAgIGxvY2FsIFhfT2Zmc2V0ID0gU2xpZGVyUG9zICogMTAwCiAgICAgIGxvY2FsIFNsaWRlclBvc2l0aW9uID0gVURpbTIubmV3KDAsIFhfT2Zmc2V0ICsgMSwgMCwgMCkKICAgICAgQ3JlYXRlVHdlZW4oU2xpZGVyLCAiUG9zaXRpb24iLCBTbGlkZXJQb3NpdGlvbiwgMC41LCBmYWxzZSkKICAgIGVuZAogICAgU2xpZGVyU2V0KERlZmF1bHQpCiAgICAKICAgIFNsaWRlci5DaGFuZ2VkOkNvbm5lY3QoZnVuY3Rpb24ocHJvcCkKICAgICAgaWYgcHJvcCA9PSAiUG9zaXRpb24iIHRoZW4KICAgICAgICBTbGlkZXIuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgbWF0aC5jbGFtcChTbGlkZXIuUG9zaXRpb24uWC5PZmZzZXQsIDAsIDEwMCksIDAuNSwgMCkKICAgICAgICBTbGlkZXJCYXIyLlNpemUgPSBVRGltMi5uZXcoMCwgU2xpZGVyLlBvc2l0aW9uLlguT2Zmc2V0LCAxLCAwKQogICAgICAgIGxvY2FsIFNsaWRlclBvcyA9IFNsaWRlci5Qb3NpdGlvbi5YLk9mZnNldCAvIDEwMAogICAgICAgIGxvY2FsIEFfMSA9IG1hdGguZmxvb3IoKChTbGlkZXJQb3MgKiBNYXhWYWx1ZSkgLyBNYXhWYWx1ZSkgKiAoTWF4VmFsdWUgLSBNaW5WYWx1ZSkgKyBNaW5WYWx1ZSkKICAgICAgICBVcGRDb3VudGVyKEFfMSkKICAgICAgZW5kCiAgICBlbmQpCiAgICByZXR1cm4ge1NsaWRlciwgSW5jcmVhc2UsIE1heFZhbHVlLCBNaW5WYWx1ZX0KICBlbmQKICAKICBmdW5jdGlvbiBVcGRhdGVTbGlkZXIoU2xpZGVyLCBOZXdWYWx1ZSkKICAgIGxvY2FsIEZyYW1lID0gU2xpZGVyWzFdCiAgICBsb2NhbCBJbmNyZWFzZSA9IFNsaWRlclsyXQogICAgbG9jYWwgTWF4ID0gU2xpZGVyWzNdICogSW5jcmVhc2UKICAgIGxvY2FsIE1pbiA9IFNsaWRlcls0XSAqIEluY3JlYXNlCiAgICAKICAgIGxvY2FsIFNsaWRlclBvcyA9IChOZXdWYWx1ZSAtIE1pbikgLyAoTWF4IC0gTWluKQogICAgbG9jYWwgWF9PZmZzZXQgPSBTbGlkZXJQb3MgKiAxMDAKICAgIGxvY2FsIFNsaWRlclBvc2l0aW9uID0gVURpbTIubmV3KDAsIFhfT2Zmc2V0ICsgMSwgMCwgMCkKICAgIENyZWF0ZVR3ZWVuKEZyYW1lLCAiUG9zaXRpb24iLCBTbGlkZXJQb3NpdGlvbiwgMC41LCBmYWxzZSkKICBlbmQKICAKICBmdW5jdGlvbiBBZGRLZXliaW5kKHBhcmVudCwgQ29uZmlncykKICAgIGxvY2FsIEtleWJpbmROYW1lID0gQ29uZmlncy5OYW1lIG9yICJTbGlkZXIhISIKICAgIGxvY2FsIEtleUNvZGUgPSBDb25maWdzLktleUNvZGUgb3IgIkUiCiAgICBsb2NhbCBEZWZhdWx0ID0gQ29uZmlncy5EZWZhdWx0IG9yIGZhbHNlCiAgICBsb2NhbCBDYWxsYmFjayA9IENvbmZpZ3MuQ2FsbGJhY2sgb3IgZnVuY3Rpb24oKSBlbmQKICAgIAogICAgbG9jYWwgRnJhbWUgPSBDcmVhdGUoIkZyYW1lIiwgcGFyZW50LCB7CiAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMjUpLAogICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29uZmlnc19IVUIuQ29yX09wdGlvbnMsCiAgICAgIE5hbWUgPSAiRnJhbWUiCiAgICB9KUNvcm5lcihGcmFtZSlTdHJva2UoRnJhbWUpCiAgICAKICAgIGxvY2FsIFRleHRMYWJlbCA9IENyZWF0ZSgiVGV4dEJ1dHRvbiIsIEZyYW1lLCB7CiAgICAgIFRleHRTaXplID0gMTIsCiAgICAgIFRleHRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfVGV4dCwKICAgICAgVGV4dCA9IEtleWJpbmROYW1lLAogICAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDEsIDApLAogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAzNSwgMCwgMCksCiAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxLAogICAgICBUZXh0WEFsaWdubWVudCA9ICJMZWZ0IiwKICAgICAgRm9udCA9IENvbmZpZ3NfSFVCLlRleHRfRm9udAogICAgfSkKICAgIAogICAgbG9jYWwgS2V5YmluZCA9IENyZWF0ZSgiVGV4dExhYmVsIiwgRnJhbWUsIHsKICAgICAgRm9udCA9IENvbmZpZ3NfSFVCLlRleHRfRm9udCwKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCAxOCwgMCwgMTgpLAogICAgICBUZXh0ID0gS2V5Q29kZSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgNSwgMCwgMy41KSwKICAgICAgVGV4dFNjYWxlZCA9IHRydWUsCiAgICAgIFRleHRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfVGV4dCwKICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgIH0pQ29ybmVyKEtleWJpbmQpU3Ryb2tlKEtleWJpbmQpCiAgICAKICAgIGxvY2FsIE9uT2ZmID0gRGVmYXVsdAogICAgVXNlcklucHV0U2VydmljZS5JbnB1dEJlZ2FuOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICAgIGlmIGlucHV0LktleUNvZGUgPT0gRW51bS5LZXlDb2RlW0tleUNvZGVdIHRoZW4KICAgICAgICBPbk9mZiA9IG5vdCBPbk9mZgogICAgICAgIENhbGxiYWNrKE9uT2ZmKQogICAgICBlbmQKICAgIGVuZCkKICAgIFRleHRTZXRDb2xvcihUZXh0TGFiZWwpCiAgZW5kCiAgCiAgZnVuY3Rpb24gQWRkVGV4dEJveChwYXJlbnQsIENvbmZpZ3MpCiAgICBsb2NhbCBUZXh0Qm94TmFtZSA9IENvbmZpZ3MuTmFtZSBvciAiVGV4dEJveCEhIgogICAgbG9jYWwgRGVmYXVsdCA9IENvbmZpZ3MuRGVmYXVsdCBvciAiVGV4dEJveCIKICAgIGxvY2FsIHBsYWNlaG9sZGVyVGV4dCA9IENvbmZpZ3MuUGxhY2Vob2xkZXJUZXh0IG9yICJUZXh0Qm94IgogICAgbG9jYWwgQ2xlYXJUZXh0ID0gQ29uZmlncy5DbGVhclRleHQgb3IgZmFsc2UKICAgIGxvY2FsIENhbGxiYWNrID0gQ29uZmlncy5DYWxsYmFjayBvciBmdW5jdGlvbigpIGVuZAogICAgCiAgICBsb2NhbCBGcmFtZSA9IENyZWF0ZSgiRnJhbWUiLCBwYXJlbnQsIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCAyNSksCiAgICAgIEJhY2tncm91bmRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfT3B0aW9ucywKICAgICAgTmFtZSA9ICJGcmFtZSIKICAgIH0pQ29ybmVyKEZyYW1lKVN0cm9rZShGcmFtZSkKICAgIAogICAgbG9jYWwgVGV4dExhYmVsID0gQ3JlYXRlKCJUZXh0QnV0dG9uIiwgRnJhbWUsIHsKICAgICAgVGV4dFNpemUgPSAxMiwKICAgICAgVGV4dENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9UZXh0LAogICAgICBUZXh0ID0gVGV4dEJveE5hbWUsCiAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMSwgMCksCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDE1MCwgMCwgMCksCiAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxLAogICAgICBUZXh0WEFsaWdubWVudCA9ICJMZWZ0IiwKICAgICAgRm9udCA9IENvbmZpZ3NfSFVCLlRleHRfRm9udAogICAgfSkKICAgIFRleHRTZXRDb2xvcihUZXh0TGFiZWwpCiAgICAKICAgIGxvY2FsIFRleHRCb3ggPSBDcmVhdGUoIlRleHRCb3giLCBGcmFtZSwgewogICAgICBTaXplID0gVURpbTIubmV3KDAsIDEyMCwgMCwgMjApLAogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAxNSwgMCwgMi41KSwKICAgICAgVGV4dENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9UZXh0LAogICAgICBUZXh0ID0gRGVmYXVsdCwKICAgICAgQ2xlYXJUZXh0T25Gb2N1cyA9IENsZWFyVGV4dCwKICAgICAgUGxhY2Vob2xkZXJUZXh0ID0gcGxhY2Vob2xkZXJUZXh0LAogICAgICBUZXh0U2NhbGVkID0gdHJ1ZSwKICAgICAgRm9udCA9IENvbmZpZ3NfSFVCLlRleHRfRm9udCwKICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgIH0pCiAgICAKICAgIGxvY2FsIExpbmUgPSBDcmVhdGUoIkZyYW1lIiwgVGV4dEJveCwgewogICAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDEpLAogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLjUsIDAsIDEsIDApLAogICAgICBBbmNob3JQb2ludCA9IFZlY3RvcjIubmV3KDAuNSwgMC41KSwKICAgICAgQmFja2dyb3VuZENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9TdHJva2UsCiAgICAgIEJvcmRlclNpemVQaXhlbCA9IDAKICAgIH0pCiAgICAKICAgIFRleHRCb3guTW91c2VFbnRlcjpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgQ3JlYXRlVHdlZW4oTGluZSwgIlNpemUiLCBVRGltMi5uZXcoMCwgMCwgMCwgMSksIDAuMywgdHJ1ZSkKICAgICAgQ3JlYXRlVHdlZW4oTGluZSwgIlNpemUiLCBVRGltMi5uZXcoMSwgMCwgMCwgMSksIDAuMywgdHJ1ZSkKICAgIGVuZCkKICAgIAogICAgVGV4dEJveC5Gb2N1c0xvc3Q6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgIENhbGxiYWNrKFRleHRCb3guVGV4dCkKICAgIGVuZCkKICBlbmQKICAKICBmdW5jdGlvbiBBZGRDb2xvclBpY2tlcihwYXJlbnQsIENvbmZpZ3MpCiAgICBsb2NhbCBuYW1lID0gQ29uZmlncy5OYW1lIG9yICJDb2xvciBQaWNrZXIiCiAgICBsb2NhbCBEZWZhdWx0ID0gQ29uZmlncy5EZWZhdWx0IG9yIENvbG9yMy5mcm9tUkdCKDAsIDAsIDIwMCkKICAgIGxvY2FsIENhbGxiYWNrID0gQ29uZmlncy5DYWxsYmFjayBvciBmdW5jdGlvbigpIGVuZAogICAgbG9jYWwgQ29sb3JILCBDb2xvclMsIENvbG9yViA9IDEsIDEsIDEKICAgIENhbGxiYWNrKERlZmF1bHQpCiAgICAKICAgIGxvY2FsIFRleHRCdXR0b24gPSBDcmVhdGUoIkZyYW1lIiwgcGFyZW50LCB7CiAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMjUpLAogICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29uZmlnc19IVUIuQ29yX09wdGlvbnMsCiAgICB9KVN0cm9rZShUZXh0QnV0dG9uKUNvcm5lcihUZXh0QnV0dG9uKQogICAgCiAgICBsb2NhbCBjbGljayA9IENyZWF0ZSgiVGV4dEJ1dHRvbiIsIFRleHRCdXR0b24sIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCAyNSksCiAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxLAogICAgICBBdXRvQnV0dG9uQ29sb3IgPSBmYWxzZSwKICAgICAgVGV4dCA9ICIiCiAgICB9KQogICAgCiAgICBsb2NhbCBUZXh0TGFiZWwgPSBDcmVhdGUoIlRleHRMYWJlbCIsIFRleHRCdXR0b24sIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAtMTAsIDAsIDI1KSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMzUsIDAsIDApLAogICAgICBUZXh0U2l6ZSA9IDEyLAogICAgICBUZXh0Q29sb3IzID0gQ29uZmlnc19IVUIuQ29yX1RleHQsCiAgICAgIFRleHRYQWxpZ25tZW50ID0gIkxlZnQiLAogICAgICBUZXh0ID0gbmFtZSwKICAgICAgRm9udCA9IENvbmZpZ3NfSFVCLlRleHRfRm9udCwKICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgIH0pCiAgICAKICAgIGxvY2FsIHBpY2tlciA9IENyZWF0ZSgiRnJhbWUiLCBUZXh0QnV0dG9uLCB7CiAgICAgIFNpemUgPSBVRGltMi5uZXcoMCwgMjAsIDAsIDIwKSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgNSwgMCwgMi41KSwKICAgICAgQmFja2dyb3VuZENvbG9yMyA9IERlZmF1bHQKICAgIH0pQ29ybmVyKHBpY2tlcilTdHJva2UocGlja2VyKQogICAgCiAgICBsb2NhbCBVSV9HcmFkZSA9IENyZWF0ZSgiSW1hZ2VCdXR0b24iLCBUZXh0QnV0dG9uLCB7CiAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgLTEwMCwgMSwgdG9udW1iZXIoLVRleHRCdXR0b24uU2l6ZS5ZLk9mZnNldCAtIDIwKSksCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDEwLCAwLCB0b251bWJlcihUZXh0QnV0dG9uLlNpemUuWS5PZmZzZXQgKyAxMi41KSksCiAgICAgIFZpc2libGUgPSBmYWxzZSwKICAgICAgSW1hZ2UgPSAicmJ4YXNzZXRpZDovLzQxNTU4MDEyNTIiCiAgICB9KUNvcm5lcihVSV9HcmFkZSlTdHJva2UoVUlfR3JhZGUpbG9jYWwgU2F2ZVBvcyA9IENyZWF0ZSgiRnJhbWUiLCBVSV9HcmFkZSwge1Zpc2libGUgPSBmYWxzZX0pCiAgICAKICAgIGxvY2FsIGdyYWRlID0gQ3JlYXRlKCJUZXh0QnV0dG9uIiwgVGV4dEJ1dHRvbiwgewogICAgICBTaXplID0gVURpbTIubmV3KDAsIDMwLCAxLCB0b251bWJlcigtVGV4dEJ1dHRvbi5TaXplLlkuT2Zmc2V0IC0gMjApKSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMSwgLTEwLCAwLCB0b251bWJlcihUZXh0QnV0dG9uLlNpemUuWS5PZmZzZXQgKyAxMi41KSksCiAgICAgIEFuY2hvclBvaW50ID0gVmVjdG9yMi5uZXcoMSwgMCksCiAgICAgIFZpc2libGUgPSBmYWxzZSwKICAgICAgVGV4dCA9ICIiCiAgICB9KUNvcm5lcihncmFkZSlTdHJva2UoZ3JhZGUpQ3JlYXRlKCJVSUdyYWRpZW50IiwgZ3JhZGUsIHsKICAgICAgUm90YXRpb24gPSA5MCwKICAgICAgQ29sb3IgPSBDb2xvclNlcXVlbmNlLm5ldyh7CiAgICAgICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygwLjAwLCBDb2xvcjMuZnJvbVJHQigyNTUsIDAsIDQpKSwKICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDAuMjAsIENvbG9yMy5mcm9tUkdCKDIzNCwgMjU1LCAwKSksCiAgICAgICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygwLjQwLCBDb2xvcjMuZnJvbVJHQigyMSwgMjU1LCAwKSksCiAgICAgICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygwLjYwLCBDb2xvcjMuZnJvbVJHQigwLCAyNTUsIDI1NSkpLAogICAgICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMC44MCwgQ29sb3IzLmZyb21SR0IoMCwgMTcsIDI1NSkpLAogICAgICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMC45MCwgQ29sb3IzLmZyb21SR0IoMjU1LCAwLCAyNTEpKSwKICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDEuMDAsIENvbG9yMy5mcm9tUkdCKDI1NSwgMCwgNCkpCiAgICAgIH0pCiAgICB9KWxvY2FsIFNhdmVQb3MyID0gQ3JlYXRlKCJGcmFtZSIsIGdyYWRlLCB7VmlzaWJsZSA9IGZhbHNlLCBTaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDApfSkKICAgIAogICAgbG9jYWwgQV8xID0gQ3JlYXRlKCJGcmFtZSIsIFRleHRCdXR0b24sIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCAwKSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMCwgMCwgMzApLAogICAgICBWaXNpYmxlID0gZmFsc2UKICAgIH0pU3Ryb2tlKEFfMSkKICAgIAogICAgbG9jYWwgU2VsZWN0MSA9IENyZWF0ZSgiRnJhbWUiLCBncmFkZSwgewogICAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDEwKSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMCwgMCwgc2VsZWN0KDMsIENvbG9yMy50b0hTVihEZWZhdWx0KSkpLAogICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMSwKICAgICAgQWN0aXZlID0gdHJ1ZSwKICAgICAgRHJhZ2dhYmxlID0gdHJ1ZQogICAgfSlDb3JuZXIoU2VsZWN0MSwge0Nvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDIsIDApfSlTdHJva2UoU2VsZWN0MSwge0NvbG9yID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSl9KQogICAgCiAgICBsb2NhbCBTZWxlY3QyID0gQ3JlYXRlKCJGcmFtZSIsIFVJX0dyYWRlLCB7CiAgICAgIFNpemUgPSBVRGltMi5uZXcoMCwgMTUsIDAsIDE1KSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgc2VsZWN0KDIsIENvbG9yMy50b0hTVihEZWZhdWx0KSksIDAsIHNlbGVjdCgxLCBDb2xvcjMudG9IU1YoRGVmYXVsdCkpKSwKICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEsCiAgICAgIEFjdGl2ZSA9IHRydWUsCiAgICAgIERyYWdnYWJsZSA9IHRydWUKICAgIH0pQ29ybmVyKFNlbGVjdDIsIHtDb3JuZXJSYWRpdXMgPSBVRGltLm5ldygyLCAwKX0pU3Ryb2tlKFNlbGVjdDIsIHtDb2xvciA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpfSkKICAKICAgIFVJX0dyYWRlLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICBsb2NhbCBtb3VzZSA9IFVzZXJJbnB1dFNlcnZpY2U6R2V0TW91c2VMb2NhdGlvbigpCiAgICAgIGxvY2FsIHNhdmVwb3MgPSBTYXZlUG9zLkFic29sdXRlUG9zaXRpb24KICAgICAgQ3JlYXRlVHdlZW4oU2VsZWN0MiwgIlBvc2l0aW9uIiwgVURpbTIubmV3KDAsIG1vdXNlLlggLSBzYXZlcG9zLlgsIDAsIHRvbnVtYmVyKG1vdXNlLlkgLSBzYXZlcG9zLlkpIC0gMzUpLCAwLjMsIGZhbHNlKQogICAgZW5kKQogICAgCiAgICBncmFkZS5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgbG9jYWwgbW91c2UgPSBVc2VySW5wdXRTZXJ2aWNlOkdldE1vdXNlTG9jYXRpb24oKS5ZIC0gMzUKICAgICAgbG9jYWwgc2F2ZXBvcyA9IFNhdmVQb3MyLkFic29sdXRlUG9zaXRpb24uWQogICAgICBDcmVhdGVUd2VlbihTZWxlY3QxLCAiUG9zaXRpb24iLCBVRGltMi5uZXcoMCwgMCwgMCwgbW91c2UgLSBzYXZlcG9zKSwgMC4zLCBmYWxzZSkKICAgIGVuZCkKICAgIAogICAgbG9jYWwgZnVuY3Rpb24gY2FsbGJhY2soKUNhbGxiYWNrKENvbG9yMy5mcm9tSFNWKENvbG9ySCwgQ29sb3JTLCBDb2xvclYpKWVuZAogICAgbG9jYWwgZnVuY3Rpb24gdXBkY29sb3JwaWNrZXIoKQogICAgICBDb2xvckggPSB0b251bWJlcihTZWxlY3QxLlBvc2l0aW9uLlkuT2Zmc2V0KSAvIDgwCiAgICAgIENvbG9yUyA9IHRvbnVtYmVyKDIxNSAtIFNlbGVjdDIuUG9zaXRpb24uWC5PZmZzZXQpIC8gMjE1CiAgICAgIENvbG9yViA9IHRvbnVtYmVyKDc1IC0gU2VsZWN0Mi5Qb3NpdGlvbi5ZLk9mZnNldCkgLyA3NQogICAgICBVSV9HcmFkZS5JbWFnZUNvbG9yMyA9IENvbG9yMy5mcm9tSFNWKENvbG9ySCwgMSwgMSkKICAgICAgcGlja2VyLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbUhTVihDb2xvckgsIENvbG9yUywgQ29sb3JWKQogICAgICBjYWxsYmFjaygpCiAgICBlbmQKICAgIAogICAgdXBkY29sb3JwaWNrZXIoKQogICAgCiAgICBTZWxlY3QxLkNoYW5nZWQ6Q29ubmVjdChmdW5jdGlvbihwcm9wKQogICAgICBpZiBwcm9wID09ICJQb3NpdGlvbiIgdGhlbgogICAgICAgIFNlbGVjdDEuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMCwgMCwgbWF0aC5jbGFtcChTZWxlY3QxLlBvc2l0aW9uLlkuT2Zmc2V0LCAwLCA4MCkpCiAgICAgICAgdXBkY29sb3JwaWNrZXIoKQogICAgICBlbmQKICAgIGVuZCkKICAgIAogICAgU2VsZWN0Mi5DaGFuZ2VkOkNvbm5lY3QoZnVuY3Rpb24ocHJvcCkKICAgICAgaWYgcHJvcCA9PSAiUG9zaXRpb24iIHRoZW4KICAgICAgICBTZWxlY3QyLlBvc2l0aW9uID0gVURpbTIubmV3KDAsIG1hdGguY2xhbXAoU2VsZWN0Mi5Qb3NpdGlvbi5YLk9mZnNldCwgMCwgMjIyKSwgMCwgbWF0aC5jbGFtcChTZWxlY3QyLlBvc2l0aW9uLlkuT2Zmc2V0LCAwLCA3NSkpCiAgICAgICAgdXBkY29sb3JwaWNrZXIoKQogICAgICBlbmQKICAgIGVuZCkKICAgIAogICAgVGV4dEJ1dHRvbi5DaGFuZ2VkOkNvbm5lY3QoZnVuY3Rpb24ocHJvcCkKICAgICAgaWYgcHJvcCA9PSAiU2l6ZSIgdGhlbgogICAgICAgIGlmIFRleHRCdXR0b24uU2l6ZS5ZLk9mZnNldCA+PSA2MCB0aGVuCiAgICAgICAgICBwaWNrZXIuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgNSwgMCwgNSkKICAgICAgICAgIFVJX0dyYWRlLlZpc2libGUgPSB0cnVlCiAgICAgICAgICBBXzEuVmlzaWJsZSA9IHRydWUKICAgICAgICAgIGdyYWRlLlZpc2libGUgPSB0cnVlCiAgICAgICAgZWxzZQogICAgICAgICAgcGlja2VyLlBvc2l0aW9uID0gVURpbTIubmV3KDAsIDUsIDAsIDIuNSkKICAgICAgICAgIFVJX0dyYWRlLlZpc2libGUgPSBmYWxzZQogICAgICAgICAgQV8xLlZpc2libGUgPSBmYWxzZQogICAgICAgICAgZ3JhZGUuVmlzaWJsZSA9IGZhbHNlCiAgICAgICAgZW5kCiAgICAgIGVuZAogICAgZW5kKQogICAgCiAgICBsb2NhbCBvbm9mZiA9IGZhbHNlCiAgICBjbGljay5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgb25vZmYgPSBub3Qgb25vZmYKICAgICAgaWYgb25vZmYgPT0gdHJ1ZSB0aGVuCiAgICAgICAgbG9jYWwgdHdlZW4gPSBUd2VlblNlcnZpY2U6Q3JlYXRlKFRleHRCdXR0b24sIFR3ZWVuSW5mby5uZXcoMC4yLCBFbnVtLkVhc2luZ1N0eWxlLkxpbmVhciksCiAgICAgICAge1NpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMTQwKX0pdHdlZW46cGxheSgpdHdlZW4uQ29tcGxldGVkOldhaXQoKQogICAgICBlbHNlCiAgICAgICAgbG9jYWwgdHdlZW4gPSBUd2VlblNlcnZpY2U6Q3JlYXRlKFRleHRCdXR0b24sIFR3ZWVuSW5mby5uZXcoMC4yLCBFbnVtLkVhc2luZ1N0eWxlLkxpbmVhciksCiAgICAgICAge1NpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMjUpfSl0d2VlbjpwbGF5KCl0d2Vlbi5Db21wbGV0ZWQ6V2FpdCgpCiAgICAgIGVuZAogICAgZW5kKQogIGVuZAogIAogIGZ1bmN0aW9uIEFkZERyb3Bkb3duKHBhcmVudCwgQ29uZmlncykKICAgIGxvY2FsIERyb3Bkb3duTmFtZSA9IENvbmZpZ3MuTmFtZSBvciAiRHJvcGRvd24hISIKICAgIGxvY2FsIERlZmF1bHQgPSBDb25maWdzLkRlZmF1bHQgb3IgIlRleHRCb3giCiAgICBsb2NhbCBPcHRpb25zID0gQ29uZmlncy5PcHRpb25zIG9yIHsiMSIsICIyIiwgIjMifQogICAgbG9jYWwgRGVmYXVsdCA9IENvbmZpZ3MuRGVmYXVsdCBvciAiMiIKICAgIGxvY2FsIENhbGxiYWNrID0gQ29uZmlncy5DYWxsYmFjayBvciBmdW5jdGlvbigpIGVuZAogICAgCiAgICBsb2NhbCBUZXh0QnV0dG9uID0gQ3JlYXRlKCJUZXh0QnV0dG9uIiwgcGFyZW50LCB7CiAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMjUpLAogICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29uZmlnc19IVUIuQ29yX09wdGlvbnMsCiAgICAgIE5hbWUgPSAiRnJhbWUiLAogICAgICBUZXh0ID0gIiIsCiAgICAgIEF1dG9CdXR0b25Db2xvciA9IGZhbHNlCiAgICB9KUNvcm5lcihGcmFtZSlTdHJva2UoRnJhbWUpCiAgICAKICAgIGxvY2FsIFRleHRMYWJlbCA9IENyZWF0ZSgiVGV4dExhYmVsIiwgVGV4dEJ1dHRvbiwgewogICAgICBUZXh0U2l6ZSA9IDEyLAogICAgICBUZXh0Q29sb3IzID0gQ29uZmlnc19IVUIuQ29yX1RleHQsCiAgICAgIFRleHQgPSBEcm9wZG93bk5hbWUsCiAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMjUpLAogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAzNSwgMCwgMCksCiAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxLAogICAgICBUZXh0WEFsaWdubWVudCA9ICJMZWZ0IiwKICAgICAgRm9udCA9IENvbmZpZ3NfSFVCLlRleHRfRm9udAogICAgfSlUZXh0U2V0Q29sb3IoVGV4dExhYmVsKQogICAgCiAgICBsb2NhbCBMaW5lID0gQ3JlYXRlKCJGcmFtZSIsIFRleHRCdXR0b24sIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCAxKSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMCwgMCwgMjUpLAogICAgICBCb3JkZXJTaXplUGl4ZWwgPSAwLAogICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29uZmlnc19IVUIuQ29yX1N0cm9rZSwKICAgICAgVmlzaWJsZSA9IGZhbHNlCiAgICB9KQogICAgCiAgICBsb2NhbCBBcnJvdyA9IENyZWF0ZSgiSW1hZ2VMYWJlbCIsIFRleHRCdXR0b24sIHsKICAgICAgSW1hZ2UgPSAicmJ4YXNzZXRpZDovLzYwMzEwOTA5OTAiLAogICAgICBTaXplID0gVURpbTIubmV3KDAsIDI1LCAwLCAyNSksCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDUsIDAsIDApLAogICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgfSkKICAgIAogICAgbG9jYWwgRGVmYXVsdFRleHQgPSBDcmVhdGUoIlRleHRMYWJlbCIsIFRleHRCdXR0b24sIHsKICAgICAgQmFja2dyb3VuZENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9IdWIsCiAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwLjEsCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDEsIC0yMCwgMCwgMi41KSwKICAgICAgQW5jaG9yUG9pbnQgPSBWZWN0b3IyLm5ldygxLCAwKSwKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCAxMDAsIDAsIDIwKSwKICAgICAgVGV4dENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9EYXJrVGV4dCwKICAgICAgVGV4dFNjYWxlZCA9IHRydWUsCiAgICAgIEZvbnQgPSBDb25maWdzX0hVQi5UZXh0X0ZvbnQsCiAgICAgIFRleHQgPSAiLi4uIgogICAgfSlDb3JuZXIoRGVmYXVsdFRleHQpU3Ryb2tlKERlZmF1bHRUZXh0KQogICAgCiAgICBsb2NhbCBTY3JvbGxCYXIgPSBDcmVhdGUoIlNjcm9sbGluZ0ZyYW1lIiwgVGV4dEJ1dHRvbiwgewogICAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDEsIC0yNSksCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDAsIDAsIDI1KSwKICAgICAgQ2FudmFzU2l6ZSA9IFVEaW0yLm5ldygpLAogICAgICBTY3JvbGxpbmdEaXJlY3Rpb24gPSAiWSIsCiAgICAgIEF1dG9tYXRpY0NhbnZhc1NpemUgPSAiWSIsCiAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxLAogICAgICBTY3JvbGxCYXJUaGlja25lc3MgPSAyCiAgICB9KUNyZWF0ZSgiVUlQYWRkaW5nIiwgU2Nyb2xsQmFyLCB7CiAgICAgIFBhZGRpbmdMZWZ0ID0gVURpbS5uZXcoMCwgMTApLAogICAgICBQYWRkaW5nUmlnaHQgPSBVRGltLm5ldygwLCAxMCksCiAgICAgIFBhZGRpbmdUb3AgPSBVRGltLm5ldygwLCAxMCksCiAgICAgIFBhZGRpbmdCb3R0b20gPSBVRGltLm5ldygwLCAxMCkKICAgIH0pQ3JlYXRlKCJVSUxpc3RMYXlvdXQiLCBTY3JvbGxCYXIsIHsKICAgICAgUGFkZGluZyA9IFVEaW0ubmV3KDAsIDUpCiAgICB9KQogICAgCiAgICBsb2NhbCBmdW5jdGlvbiBBZGRPcHRpb24oT3B0aW9uTmFtZSkKICAgICAgbG9jYWwgVGV4dEJ1dHRvbiA9IENyZWF0ZSgiVGV4dEJ1dHRvbiIsIFNjcm9sbEJhciwgewogICAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMTUpLAogICAgICAgIFRleHQgPSBPcHRpb25OYW1lLAogICAgICAgIEZvbnQgPSBDb25maWdzX0hVQi5UZXh0X0ZvbnQsCiAgICAgICAgVGV4dFNpemUgPSAxMiwKICAgICAgICBUZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMTgwLCAxODAsIDE4MCksCiAgICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgICAgfSlDb3JuZXIoVGV4dEJ1dHRvbikKICAgICAgCiAgICAgIGxvY2FsIFNlbGVjdFRhYmxlID0ge30KICAgICAgbG9jYWwgT25PZmYgPSBmYWxzZQogICAgICBpZiBPcHRpb25OYW1lID09IERlZmF1bHQgdGhlbgogICAgICAgIE9uT2ZmID0gdHJ1ZQogICAgICAgIFRleHRCdXR0b24uQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAuOAogICAgICAgIFRleHRCdXR0b24uVGV4dENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9UZXh0CiAgICAgICAgRGVmYXVsdFRleHQuVGV4dCA9IE9wdGlvbk5hbWUKICAgICAgICBDYWxsYmFjayhPcHRpb25OYW1lKQogICAgICBlbmQKICAgICAgCiAgICAgIFRleHRCdXR0b24uTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgZm9yIF8sdiBpbiBwYWlycyhTY3JvbGxCYXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgIGlmIHY6SXNBKCJUZXh0QnV0dG9uIikgdGhlbgogICAgICAgICAgICB2LkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICAgICAgICAgIHYuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDE4MCwgMTgwLCAxODApCiAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICBEZWZhdWx0VGV4dC5UZXh0ID0gT3B0aW9uTmFtZQogICAgICAgIENhbGxiYWNrKE9wdGlvbk5hbWUpCiAgICAgICAgVGV4dEJ1dHRvbi5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMC44CiAgICAgICAgVGV4dEJ1dHRvbi5UZXh0Q29sb3IzID0gQ29uZmlnc19IVUIuQ29yX1RleHQKICAgICAgZW5kKQogICAgZW5kCiAgICAKICAgIGZvciBfLHYgaW4gcGFpcnMoT3B0aW9ucykgZG8KICAgICAgQWRkT3B0aW9uKHYpCiAgICBlbmQKICAgIAogICAgbG9jYWwgRHJvcE9uT2ZmID0gZmFsc2UKICAgIFRleHRCdXR0b24uTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgIGxvY2FsIE9wdGlvblNpemUsIE9wdGlvbnNOdW1iZXIgPSAyNSwgMAogICAgICBmb3IgXyx2IGluIHBhaXJzKFNjcm9sbEJhcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIGlmIHY6SXNBKCJUZXh0QnV0dG9uIikgYW5kIE9wdGlvbnNOdW1iZXIgPCA1IHRoZW4KICAgICAgICAgIE9wdGlvbnNOdW1iZXIgPSBPcHRpb25zTnVtYmVyICsgMQogICAgICAgICAgT3B0aW9uU2l6ZSA9IE9wdGlvblNpemUgKyB0b251bWJlcih2LlNpemUuWS5PZmZzZXQgKyAxMCkKICAgICAgICBlbmQKICAgICAgZW5kCiAgICAgIGlmIG5vdCBEcm9wT25PZmYgdGhlbgogICAgICAgIENyZWF0ZVR3ZWVuKFRleHRCdXR0b24sICJTaXplIiwgVURpbTIubmV3KDEsIDAsIDAsIE9wdGlvblNpemUpLCAwLjMsIGZhbHNlKQogICAgICAgIENyZWF0ZVR3ZWVuKEFycm93LCAiUm90YXRpb24iLCAxODAsIDAuMywgZmFsc2UpCiAgICAgICAgRHJvcE9uT2ZmID0gdHJ1ZQogICAgICAgIExpbmUuVmlzaWJsZSA9IHRydWUKICAgICAgZWxzZQogICAgICAgIENyZWF0ZVR3ZWVuKFRleHRCdXR0b24sICJTaXplIiwgVURpbTIubmV3KDEsIDAsIDAsIDI1KSwgMC4zLCBmYWxzZSkKICAgICAgICBDcmVhdGVUd2VlbihBcnJvdywgIlJvdGF0aW9uIiwgMCwgMC4zLCB0cnVlKQogICAgICAgIERyb3BPbk9mZiA9IGZhbHNlCiAgICAgICAgTGluZS5WaXNpYmxlID0gZmFsc2UKICAgICAgZW5kCiAgICBlbmQpCiAgICByZXR1cm4ge1Njcm9sbEJhciwgRGVmYXVsdCwgQ2FsbGJhY2ssIERlZmF1bHRUZXh0fQogIGVuZAogIAogIGZ1bmN0aW9uIFVwZGF0ZURyb3Bkb3duKERyb3Bkb3duLCBOZXdPcHRpb25zKQogICAgbG9jYWwgU2Nyb2xsQmFyID0gRHJvcGRvd25bMV0KICAgIGxvY2FsIERlZmF1bHQgPSBEcm9wZG93blsyXQogICAgbG9jYWwgQ2FsbGJhY2sgPSBEcm9wZG93blszXQogICAgbG9jYWwgRGVmYXVsdFRleHQgPSBEcm9wZG93bls0XQogICAgCiAgICBmb3IgXyx2IGluIHBhaXJzKFNjcm9sbEJhcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICBpZiB2OklzQSgiVGV4dEJ1dHRvbiIpIHRoZW4KICAgICAgICB2OkRlc3Ryb3koKQogICAgICBlbmQKICAgIGVuZAogICAgCiAgICBsb2NhbCBmdW5jdGlvbiBBZGRPcHRpb24oT3B0aW9uTmFtZSkKICAgICAgbG9jYWwgVGV4dEJ1dHRvbiA9IENyZWF0ZSgiVGV4dEJ1dHRvbiIsIFNjcm9sbEJhciwgewogICAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMTUpLAogICAgICAgIFRleHQgPSBPcHRpb25OYW1lLAogICAgICAgIEZvbnQgPSBDb25maWdzX0hVQi5UZXh0X0ZvbnQsCiAgICAgICAgVGV4dFNpemUgPSAxMiwKICAgICAgICBUZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMTgwLCAxODAsIDE4MCksCiAgICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgICAgfSlDb3JuZXIoVGV4dEJ1dHRvbikKICAgICAgCiAgICAgIGxvY2FsIFNlbGVjdFRhYmxlID0ge30KICAgICAgbG9jYWwgT25PZmYgPSBmYWxzZQogICAgICBpZiBPcHRpb25OYW1lID09IERlZmF1bHQgdGhlbgogICAgICAgIE9uT2ZmID0gdHJ1ZQogICAgICAgIFRleHRCdXR0b24uQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAuOAogICAgICAgIFRleHRCdXR0b24uVGV4dENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9UZXh0CiAgICAgICAgRGVmYXVsdFRleHQuVGV4dCA9IE9wdGlvbk5hbWUKICAgICAgICBDYWxsYmFjayhPcHRpb25OYW1lKQogICAgICBlbHNlCiAgICAgICAgRGVmYXVsdFRleHQuVGV4dCA9ICIuLi4iCiAgICAgIGVuZAogICAgICAKICAgICAgVGV4dEJ1dHRvbi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICBmb3IgXyx2IGluIHBhaXJzKFNjcm9sbEJhcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgaWYgdjpJc0EoIlRleHRCdXR0b24iKSB0aGVuCiAgICAgICAgICAgIHYuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgICAgICAgICAgdi5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMTgwLCAxODAsIDE4MCkKICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIERlZmF1bHRUZXh0LlRleHQgPSBPcHRpb25OYW1lCiAgICAgICAgQ2FsbGJhY2soT3B0aW9uTmFtZSkKICAgICAgICBUZXh0QnV0dG9uLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwLjgKICAgICAgICBUZXh0QnV0dG9uLlRleHRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfVGV4dAogICAgICBlbmQpCiAgICBlbmQKICAgIAogICAgZm9yIF8sdiBpbiBwYWlycyhOZXdPcHRpb25zKSBkbwogICAgICBBZGRPcHRpb24odikKICAgIGVuZAogIGVuZAogIAogIGZ1bmN0aW9uIEFkZFRleHRMYWJlbChwYXJlbnQsIENvbmZpZ3MpCiAgICBsb2NhbCBMYWJlbE5hbWUgPSBDb25maWdzWzFdIG9yIENvbmZpZ3MuTmFtZSBvciAiVGV4dCBMYWJlbCEhIgogICAgCiAgICBsb2NhbCBGcmFtZSA9IENyZWF0ZSgiRnJhbWUiLCBwYXJlbnQsIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCAyNSksCiAgICAgIEJhY2tncm91bmRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfT3B0aW9ucywKICAgICAgTmFtZSA9ICJGcmFtZSIKICAgIH0pQ29ybmVyKEZyYW1lKVN0cm9rZShGcmFtZSkKICAgIAogICAgbG9jYWwgVGV4dEJ1dHRvbiA9IENyZWF0ZSgiVGV4dEJ1dHRvbiIsIEZyYW1lLCB7CiAgICAgIFRleHRTaXplID0gMTIsCiAgICAgIFRleHRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfVGV4dCwKICAgICAgVGV4dCA9IExhYmVsTmFtZSwKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCAyNSksCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDIwLCAwLCAwKSwKICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEsCiAgICAgIFRleHRYQWxpZ25tZW50ID0gIkxlZnQiLAogICAgICBGb250ID0gQ29uZmlnc19IVUIuVGV4dF9Gb250CiAgICB9KQogICAgVGV4dFNldENvbG9yKFRleHRCdXR0b24pCiAgICByZXR1cm4gVGV4dEJ1dHRvbgogIGVuZAogIAogIGZ1bmN0aW9uIFNldExhYmVsKGxhYmVsLCBOZXdWYWx1ZSkKICAgIGxhYmVsLlRleHQgPSBOZXdWYWx1ZQogIGVuZAogIAogIGZ1bmN0aW9uIEFkZEltYWdlTGFiZWwocGFyZW50LCBDb25maWdzKQogICAgbG9jYWwgTGFiZWxOYW1lID0gQ29uZmlnc1sxXSBvciBDb25maWdzLk5hbWUgb3IgIiIKICAgIGxvY2FsIExhYmVsSW1hZ2UgPSBDb25maWdzWzJdIG9yIENvbmZpZ3MuSW1hZ2Ugb3IgIkltYWdlIExhYmVsIgogICAgCiAgICBsb2NhbCBGcmFtZSA9IENyZWF0ZSgiRnJhbWUiLCBwYXJlbnQsIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCA5NSwgMCwgMTEwKSwKICAgICAgQmFja2dyb3VuZENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9PcHRpb25zLAogICAgICBOYW1lID0gIkZyYW1lIgogICAgfSlDb3JuZXIoRnJhbWUpU3Ryb2tlKEZyYW1lKQogICAgCiAgICBsb2NhbCBUZXh0QnV0dG9uID0gQ3JlYXRlKCJUZXh0QnV0dG9uIiwgRnJhbWUsIHsKICAgICAgVGV4dFNpemUgPSAxMiwKICAgICAgVGV4dENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9UZXh0LAogICAgICBUZXh0ID0gTGFiZWxOYW1lLAogICAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDI1KSwKICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEsCiAgICAgIEZvbnQgPSBDb25maWdzX0hVQi5UZXh0X0ZvbnQKICAgIH0pCiAgICAKICAgIGxvY2FsIEltYWdlTGFiZWwgPSBDcmVhdGUoIkltYWdlTGFiZWwiLCBGcmFtZSwgewogICAgICBJbWFnZSA9IExhYmVsSW1hZ2UsCiAgICAgIFNpemUgPSBVRGltMi5uZXcoMCwgNzUsIDAsIDc1KSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMTAsIDAsIDI1KQogICAgfSkKICAgIFRleHRTZXRDb2xvcihUZXh0QnV0dG9uKQogICAgcmV0dXJuIEltYWdlTGFiZWwKICBlbmQKICAKICBmdW5jdGlvbiBTZXRJbWFnZShsYWJlbCwgTmV3SW1hZ2UpCiAgICBsYWJlbC5JbWFnZSA9IE5ld0ltYWdlCiAgZW5kCiAgCiAgZnVuY3Rpb24gQWRkUGFyYWdyYXBoKHBhcmVudCwgQ29uZmlncykKICAgIGxvY2FsIFBhcmFncmFwaE5hbWUxID0gQ29uZmlnc1sxXSBvciBDb25maWdzLlRpdGxlIG9yICJQYXJhZ3JhcGghISIKICAgIGxvY2FsIFBhcmFncmFwaE5hbWUyID0gQ29uZmlnc1sxXSBvciBDb25maWdzLlRleHQgb3IgIlBhcmFncmFwaCEhIgogICAgCiAgICBsb2NhbCBGcmFtZSA9IENyZWF0ZSgiRnJhbWUiLCBwYXJlbnQsIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCAyNSksCiAgICAgIEJhY2tncm91bmRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfT3B0aW9ucywKICAgICAgTmFtZSA9ICJGcmFtZSIsCiAgICAgIEF1dG9tYXRpY1NpemUgPSAiWSIKICAgIH0pQ29ybmVyKEZyYW1lKVN0cm9rZShGcmFtZSlDcmVhdGUoIlVJTGlzdExheW91dCIsIEZyYW1lKUNyZWF0ZSgiVUlQYWRkaW5nIiwgRnJhbWUsIHsKICAgICAgUGFkZGluZ0xlZnQgPSBVRGltLm5ldygwLCAyMCksIFBhZGRpbmdSaWdodCA9IFVEaW0ubmV3KDAsIDEwKSwgUGFkZGluZ1RvcCA9IFVEaW0ubmV3KDAsIDUpLCBQYWRkaW5nQm90dG9tID0gVURpbS5uZXcoMCwgNSkKICAgIH0pCiAgICAKICAgIGxvY2FsIFRleHRCdXR0b24gPSBDcmVhdGUoIlRleHRCdXR0b24iLCBGcmFtZSwgewogICAgICBOYW1lID0gIkZyYW1lIiwKICAgICAgVGV4dFNpemUgPSAxMiwKICAgICAgVGV4dENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9UZXh0LAogICAgICBUZXh0ID0gUGFyYWdyYXBoTmFtZTEsCiAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMCksCiAgICAgIEF1dG9tYXRpY1NpemUgPSAiWSIsCiAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxLAogICAgICBUZXh0WEFsaWdubWVudCA9ICJMZWZ0IiwKICAgICAgVGV4dFlBbGlnbm1lbnQgPSAiVG9wIiwKICAgICAgRm9udCA9IENvbmZpZ3NfSFVCLlRleHRfRm9udCwKICAgICAgVGV4dFdyYXBwZWQgPSB0cnVlCiAgICB9KVRleHRTZXRDb2xvcihUZXh0QnV0dG9uKQogICAgCiAgICBsb2NhbCBUZXh0TGFiZWwgPSBDcmVhdGUoIlRleHRMYWJlbCIsIEZyYW1lLCB7CiAgICAgIE5hbWUgPSAiRnJhbWUiLAogICAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDApLAogICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMSwKICAgICAgQXV0b21hdGljU2l6ZSA9ICJZIiwKICAgICAgVGV4dFhBbGlnbm1lbnQgPSAiTGVmdCIsCiAgICAgIFRleHRZQWxpZ25tZW50ID0gIlRvcCIsCiAgICAgIFRleHRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfRGFya1RleHQsCiAgICAgIFRleHRTaXplID0gMTEsCiAgICAgIFRleHQgPSBQYXJhZ3JhcGhOYW1lMiwKICAgICAgRm9udCA9IENvbmZpZ3NfSFVCLlRleHRfRm9udCwKICAgICAgVGV4dFdyYXBwZWQgPSB0cnVlCiAgICB9KQogICAgcmV0dXJuIHtUZXh0QnV0dG9uLCBUZXh0TGFiZWx9CiAgZW5kCiAgCiAgZnVuY3Rpb24gU2V0UGFyYWdyYXBoKFBhcmFncmFwaCwgTmV3VmFsdWUpCiAgICBQYXJhZ3JhcGhbMV0uVGV4dCA9IE5ld1ZhbHVlWzFdCiAgICBQYXJhZ3JhcGhbMl0uVGV4dCA9IE5ld1ZhbHVlWzJdCiAgZW5kCiAgCiAgZnVuY3Rpb24gQWRkU2VjdGlvbihwYXJlbnQsIENvbmZpZ3MpCiAgICBsb2NhbCBTZWN0aW9uTmFtZSA9IENvbmZpZ3NbMV0gb3IgQ29uZmlncy5OYW1lIG9yICJTZWN0aW9uISEiCiAgICAKICAgIGxvY2FsIEZyYW1lID0gQ3JlYXRlKCJGcmFtZSIsIHBhcmVudCwgewogICAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDI1KSwKICAgICAgQmFja2dyb3VuZENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9IdWIsCiAgICAgIE5hbWUgPSAiRnJhbWUiLAogICAgICBUcmFuc3BhcmVuY3kgPSAxCiAgICB9KUNvcm5lcihGcmFtZSkKICAgIAogICAgbG9jYWwgVGV4dEJ1dHRvbiA9IENyZWF0ZSgiVGV4dEJ1dHRvbiIsIEZyYW1lLCB7CiAgICAgIFRleHRTaXplID0gMTIsCiAgICAgIFRleHRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfRGFya1RleHQsCiAgICAgIFRleHQgPSBTZWN0aW9uTmFtZSwKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCAyNSksCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDEwLCAwLCAwKSwKICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEsCiAgICAgIFRleHRYQWxpZ25tZW50ID0gIkxlZnQiLAogICAgICBGb250ID0gQ29uZmlnc19IVUIuVGV4dF9Gb250CiAgICB9KQogICAgcmV0dXJuIFRleHRCdXR0b24KICBlbmQKICAKICBmdW5jdGlvbiBTZXRTZWN0aW9uKFNlY3Rpb24sIE5ld05hbWUpCiAgICBTZWN0aW9uLlRleHQgPSBOZXdOYW1lCiAgZW5kCiAgCiAgZnVuY3Rpb24gQWRkRGlzY29yZChwYXJlbnQsIENvbmZpZ3MpCiAgICBsb2NhbCBEaXNjb3JkTGluayA9IENvbmZpZ3NbMV0gb3IgQ29uZmlncy5EaXNjb3JkTGluayBvciAiaHR0cHM6Ly9kaXNjb3JkLmdnLyIKICAgIGxvY2FsIERpc2NvcmRJY29uID0gQ29uZmlnc1syXSBvciBDb25maWdzLkRpc2NvcmRJY29uIG9yICJyYnhhc3NldGlkOi8vIgogICAgbG9jYWwgRGlzY29yZFRpdGxlID0gQ29uZmlnc1szXSBvciBDb25maWdzLkRpc2NvcmRUaXRsZSBvciAiIgogICAgCiAgICBsb2NhbCBGcmFtZSA9IENyZWF0ZSgiRnJhbWUiLCBwYXJlbnQsIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCAxMTApLAogICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMzAsIDMwLCAzMCksCiAgICAgIE5hbWUgPSAiRnJhbWUiLAogICAgICBBdXRvbWF0aWNTaXplID0gIlkiCiAgICB9KQogICAgCiAgICBsb2NhbCBMaW5rTGFiZWwgPSBDcmVhdGUoIlRleHRMYWJlbCIsIEZyYW1lLCB7CiAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMjUpLAogICAgICBUZXh0ID0gRGlzY29yZExpbmssCiAgICAgIFRleHRYQWxpZ25tZW50ID0gIkxlZnQiLAogICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMTIsIDAsIDApLAogICAgICBUZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMCwgMTIwLCAyNTUpLAogICAgICBGb250ID0gRW51bS5Gb250LkdvdGhhbUJvbGQsCiAgICAgIFRleHRTaXplID0gMTQKICAgIH0pCiAgICAKICAgIGxvY2FsIFRpdGxlTGFiZWwgPSBDcmVhdGUoIlRleHRMYWJlbCIsIEZyYW1lLCB7CiAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMjUpLAogICAgICBUZXh0ID0gRGlzY29yZFRpdGxlLAogICAgICBUZXh0WEFsaWdubWVudCA9ICJMZWZ0IiwKICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEsCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDYwLCAwLCAyNSksCiAgICAgIFRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyMDAsIDIwMCwgMjAwKSwKICAgICAgRm9udCA9IEVudW0uRm9udC5Hb3RoYW1Cb2xkLAogICAgICBUZXh0U2l6ZSA9IDE0CiAgICB9KQogICAgCiAgICBsb2NhbCBJY29uTGFiZWwgPSBDcmVhdGUoIkltYWdlTGFiZWwiLCBGcmFtZSwgewogICAgICBTaXplID0gVURpbTIubmV3KDAsIDQwLCAwLCA0MCksCiAgICAgIEFuY2hvclBvaW50ID0gVmVjdG9yMi5uZXcoMCwgMC41KSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMTIsIDAuNDUsIDApLAogICAgICBJbWFnZSA9IERpc2NvcmRJY29uCiAgICB9KUNvcm5lcihJY29uTGFiZWwpCiAgICAKICAgIGxvY2FsIEpvaW5CdXR0b24gPSBDcmVhdGUoIlRleHRCdXR0b24iLCBGcmFtZSwgewogICAgICBTaXplID0gVURpbTIubmV3KDEsIC0yNCwgMCwgMjUpLAogICAgICBBbmNob3JQb2ludCA9IFZlY3RvcjIubmV3KDAuNSwgMSksCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAuNSwgMCwgMSwgLTgpLAogICAgICBUZXh0ID0gIkpvaW4iLAogICAgICBGb250ID0gRW51bS5Gb250LkdvdGhhbUJvbGQsCiAgICAgIFRleHRTaXplID0gMTUsCiAgICAgIFRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyMjAsIDIyMCwgMjIwKSwKICAgICAgQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDUwLCAyMDAsIDUwKQogICAgfSlDb3JuZXIoSWNvbkxhYmVsKQogICAgCiAgICBsb2NhbCB0aW1lID0gdGljaygpCiAgICBDbGlja0NvbnRlciA9IDAKICAgIEpvaW5CdXR0b24uTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgIGlmIENsaWNrQ29udGVyID09IDAgb3IgdGljaygpIC0gdGltZSA+IDUgdGhlbiB0aW1lID0gdGljaygpIHNldGNsaXBib2FyZChEaXNjb3JkTGluaykgQ2xpY2tDb250ZXIgPSBDbGlja0NvbnRlciArIDEKICAgICAgICBKb2luQnV0dG9uLlRleHQgPSAiQ29waWVkIHRvIENsaXBib2FyZCIKICAgICAgICBKb2luQnV0dG9uLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxMDAsIDEwMCwgMTAwKQogICAgICAgIEpvaW5CdXR0b24uVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDE1MCwgMTUwLCAxNTApCiAgICAgICAgdGFzay53YWl0KDUpCiAgICAgICAgSm9pbkJ1dHRvbi5UZXh0ID0gIkpvaW4iCiAgICAgICAgSm9pbkJ1dHRvbi5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoNTAsIDIwMCwgNTApCiAgICAgICAgSm9pbkJ1dHRvbi5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjIwLCAyMjAsIDIyMCkKICAgICAgZW5kCiAgICBlbmQpCiAgZW5kCiAgcmV0dXJuIE1lbnUKZW5k"))()